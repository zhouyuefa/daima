import{_ as e,f as l,y as a,g as t,T as i,S as r,r as n,o as s,c as o,a as d,d as u,w as p,e as c,t as b,j as m,H as h,aw as _,ad as g,ae as v,D as w,M as f,N as y,B as x,A as W,E as k,aa as C}from"./index-BdR_P0jW.js";/* empty css                */import{E as D}from"./index-C5CR2e01.js";import{E as V,a as H}from"./index-D1fpWslZ.js";const j={class:"boxElMain"},z={class:"box boxFlex"},E={class:"detail-order"},N={style:{width:"100%","padding-left":"20px"}},P={style:{"margin-left":"20px"}},T={style:{"margin-left":"20px"}},U={class:"dialog-footer"},I=e({__name:"index",setup(e){const I=l({getList:"/admin/comm_withdraw/lists",getDetail:"/admin/comm_withdraw/detail",exportUrl:"/admin/comm_withdraw/export"}),O=l([{label:"申请中",value:"0"},{label:"已通过",value:"1"},{label:"已驳回",value:"2"}]),R=l([{type:"Input",label:"用户ID",prop:"user_id",placeholder:"请输入类型名称",width:"180px"},{type:"Input",label:"手机号",prop:"mobile",placeholder:"请输入类型名称",width:"180px"},{type:"Select",label:"状态",prop:"status",width:"180px",options:O,placeholder:"请选择状态"},{type:"DateRange",label:"日期",prop:"created_at",placeholder:"请输入类型名称",width:"280px"}]),S=l({name:"",status:""}),A=l([{label:"查 询",icon:"Search",auth:"admin/comm_withdraw/lists",handle:()=>X()},{label:"重置",auth:"admin/comm_withdraw/lists",handle:()=>Z()},{label:"排序",popover:!0}]),F=l([{label:"导出",icon:"Download",auth:"admin/comm_withdraw/export",handle:()=>L()}]),L=async()=>{const e=await a(I.value.exportUrl,{...S.value});if(e){const l=document.createElement("a");l.href=e,l.target="_blank",l.download=e.split("/").pop(),document.body.appendChild(l),l.click(),document.body.removeChild(l)}},q=l([]),M=l({page:1,page_size:20,totalPages:0}),Y=l([{label:"序号",prop:"id",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"用户ID",prop:"user_id",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"用户名",prop:"nickname",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"手机号",prop:"mobile",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"提现金额",prop:"withdraw_price",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"手续费",prop:"handle_price",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"到账金额",prop:"real_price",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"账户类型",prop:"bank_type_name",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"名称",prop:"account_name",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"银行账号",prop:"account_number",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0},{label:"开户行",prop:"branch",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"创建时间",prop:"created_at",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0},{label:"修改时间",prop:"updated_at",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0},{label:"状态",prop:"status_text",align:"center",type:"string",sortable:!1,minWidth:"110",show:!0},{label:"操作",minWidth:"100",type:"button",show:!0,fixed:"right",align:"center",btnList:[{hide:e=>B(e),label:"审核",type:"default",auth:"admin/comm_withdraw/audit",handle:(e,l)=>Q(l)}]}]),B=e=>0!==e.status,G=l(!1),J=t({}),K=t({}),Q=e=>{(async e=>{const l=await m(I.value.getDetail,{id:e});l&&Object.assign(K,l)})(e.id),Object.assign(J,e),oe(),G.value=!0},X=()=>{M.value.page=1,$()},Z=()=>{(e=>{for(const l of Object.keys(e))delete e[l]})(S.value),M.value.page=1,M.value.page_size=20,S.value.status="",$()},$=async()=>{const e=await a(I.value.getList,{...M.value,...S.value});if(e&&(q.value=[],M.value.total=e.page.total||0,q.value.splice(0),e.list.length>0))for(let l=0;l<e.list.length;l++){let a=e.list[l];q.value.push(a)}};i.on("getCheckData",(e=>{(e=>{const l=[];e.list.forEach((e=>{l.push(e.label)})),Y.value.sort(((e,a)=>"操作"===e.label?1:l.indexOf(e.label)-l.indexOf(a.label))),Y.value=Y.value.map((l=>e.data.includes(l.label)||"操作"===l.label?{...l,show:!0}:{...l,show:!1}))})(e)})),r((()=>{$()}));const ee=async()=>{te.value.validate((async e=>{if(e){let e={id:J.id,status:ae.status,remark:ae.remark};if(!(await a("/admin/comm_withdraw/audit",e)))return;$(),h.success("操作成功"),G.value=!1}}))},le=l([{label:"子订单号",prop:"order_goods_info",subProp:"order_no",align:"center",type:"object",sortable:!1,minWidth:"120",show:!0},{label:"订单金额（TN）",prop:"order_price",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"订单金额（元）",prop:"order_price_r",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"分佣类型",prop:"com_type_text",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"总分佣比例",prop:"com_total_rate",align:"center",type:"percentage",sortable:!1,minWidth:"120",show:!0},{label:"类型分佣总比例",prop:"com_type_rate",align:"center",type:"percentage",sortable:!1,minWidth:"120",show:!0},{label:"等级分佣比例",prop:"level_rate",align:"center",type:"percentage",sortable:!1,minWidth:"120",show:!0},{label:"应得佣金（TN）",prop:"com_price",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"汇率",prop:"exchange_rate",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"折算应得佣金（元）",prop:"com_price_r",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"创建时间",prop:"created_at",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0},{label:"完成时间",prop:"complete_time",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0},{label:"发放时间",prop:"settle_time",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0},{label:"取消时间",prop:"cancel_time",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0},{label:"状态",prop:"status_text",align:"center",type:"string",sortable:!1,minWidth:"110",show:!0}]),ae=t({}),te=l(null),ie=l({status:[{required:!0,message:"请选择",trigger:"change"}],remark:[{required:!0,message:"请输入",trigger:"blur"}]}),re=l([]),ne=l({page:1,page_size:10}),se=l(""),oe=async()=>{let e={user_id:J.user_id,...ne.value,status:se.value};const l=await a("/admin/user/lists",e);if(l&&(re.value.splice(0),l.list.length>0))for(let a=0;a<l.list.length;a++){let e=l.list[a];re.value.push(e)}};return(e,l)=>{const a=_,t=n("cusTable"),i=D,r=V,m=H,h=g,I=v,O=w,L=f,B=y,J=x,Q=W,ne=k,de=C;return s(),o("div",j,[d("div",z,[u(i,null,{default:p((()=>[u(a,{searchForm:R.value,searchData:S.value,searchHandleRight:F.value,searchHandle:A.value,tableCols:Y.value,onHandleEnterSearch:X,onHandleReset:Z},null,8,["searchForm","searchData","searchHandleRight","searchHandle","tableCols"]),u(t,{ref:"cusTable",height:"calc(100vh - 240px)","row-key":"id",isPagination:!0,isHandle:!0,tableCols:Y.value,tableData:q.value,tablePage:M.value,onHandleCurrentChange:$},null,8,["tableCols","tableData","tablePage"])])),_:1})]),u(de,{"close-on-click-modal":!1,modelValue:G.value,"onUpdate:modelValue":l[4]||(l[4]=e=>G.value=e),title:"提现审核",fullscreen:""},{footer:p((()=>[d("div",U,[u(O,{onClick:l[3]||(l[3]=e=>G.value=!1)},{default:p((()=>l[7]||(l[7]=[c("取消")]))),_:1}),u(O,{type:"primary",onClick:ee},{default:p((()=>l[8]||(l[8]=[c("确定")]))),_:1})])])),default:p((()=>{var e,a,i;return[d("div",E,[u(m,{title:"提现信息",direction:"vertical",column:6,size:"small",border:"",style:{width:"50%"}},{default:p((()=>[u(r,{label:"用户名"},{default:p((()=>{var e;return[c(b(null==(e=null==K?void 0:K.user_info)?void 0:e.nickname),1)]})),_:1}),u(r,{label:"手机号"},{default:p((()=>{var e;return[c(b(null==(e=null==K?void 0:K.user_info)?void 0:e.mobile),1)]})),_:1}),u(r,{label:"提现金额（元）"},{default:p((()=>[c(b(K.withdraw_price),1)])),_:1}),u(r,{label:"手续费（元）"},{default:p((()=>[c(b(K.handle_price),1)])),_:1}),u(r,{label:"到账金额（元）"},{default:p((()=>[c(b(K.real_price),1)])),_:1}),u(r,{label:"提现时间"},{default:p((()=>[c(b(K.created_at),1)])),_:1})])),_:1}),u(m,{title:"提现账号信息",direction:"vertical",column:6,size:"small",border:"",style:{width:"49%","margin-left":"1%"}},{default:p((()=>[u(r,{label:"账户类型"},{default:p((()=>[c(b(K.bank_type_name),1)])),_:1}),u(r,{label:"名称"},{default:p((()=>[c(b(K.account_name),1)])),_:1}),u(r,{label:"银行账号"},{default:p((()=>[c(b(K.account_number),1)])),_:1}),u(r,{label:"开户行"},{default:p((()=>[c(b(K.account_bank),1)])),_:1}),u(r,{label:"开户支行"},{default:p((()=>[c(b(K.branch),1)])),_:1})])),_:1}),u(m,{title:"用户账户信息",direction:"vertical",column:6,size:"small",border:"",style:{width:"50%","margin-top":"1%"}},{default:p((()=>[u(r,{label:"账户余额（WACN）"},{default:p((()=>{var e;return[c(b(null==(e=null==K?void 0:K.user_info)?void 0:e.valid_wacn),1)]})),_:1}),u(r,{label:"账户冻结余额（WACN）"},{default:p((()=>{var e;return[c(b(null==(e=null==K?void 0:K.user_info)?void 0:e.freeze_wacn),1)]})),_:1}),u(r,{label:"佣金可用余额（CNY）"},{default:p((()=>{var e;return[c(b(null==(e=null==K?void 0:K.user_info)?void 0:e.com_rmb),1)]})),_:1}),u(r,{label:"佣金冻结余额（CNY）"},{default:p((()=>{var e;return[c(b(null==(e=null==K?void 0:K.user_info)?void 0:e.com_freeze_rmb),1)]})),_:1})])),_:1}),u(m,{title:"用户提现统计",direction:"vertical",column:6,size:"small",border:"",style:{width:"49%","margin-left":"1%","margin-top":"1%"}},{default:p((()=>[u(r,{label:"提现次数"},{default:p((()=>{var e;return[c(b(null==(e=null==K?void 0:K.user_statistics)?void 0:e.withdraw_num),1)]})),_:1}),u(r,{label:"提现流水总额"},{default:p((()=>{var e;return[c(b(null==(e=null==K?void 0:K.user_statistics)?void 0:e.withdraw_price),1)]})),_:1}),u(r,{label:"已提现总额"},{default:p((()=>{var e;return[c(b(null==(e=null==K?void 0:K.user_statistics)?void 0:e.success_withdraw_price),1)]})),_:1}),u(r,{label:"已通过"},{default:p((()=>{var e;return[c(b(null==(e=null==K?void 0:K.user_statistics)?void 0:e.success_num),1)]})),_:1}),u(r,{label:"未审核"},{default:p((()=>{var e;return[c(b(null==(e=null==K?void 0:K.user_statistics)?void 0:e.await_num),1)]})),_:1}),u(r,{label:"已驳回"},{default:p((()=>{var e;return[c(b(null==(e=null==K?void 0:K.user_statistics)?void 0:e.reject_num),1)]})),_:1})])),_:1}),u(m,{title:"佣金明细",style:{"margin-top":"1%",width:"100%"}}),d("div",N,[d("span",null,"累计已分佣合计："+b(null==(e=null==K?void 0:K.user_bill_statistics)?void 0:e.success_price)+"元",1),d("span",P,"累计待分佣合计："+b(null==(a=null==K?void 0:K.user_bill_statistics)?void 0:a.await_price)+"元",1),d("span",T,"累计未分佣合计："+b(null==(i=null==K?void 0:K.user_bill_statistics)?void 0:i.no_price)+"元",1)]),d("p",null,[l[6]||(l[6]=c("状态： ")),u(I,{style:{width:"180px"},modelValue:se.value,"onUpdate:modelValue":l[0]||(l[0]=e=>se.value=e),clearable:""},{default:p((()=>[u(h,{label:"未分佣",value:1}),u(h,{label:"已完成待分佣",value:2}),u(h,{label:"已分佣",value:3}),u(h,{label:"取消",value:4})])),_:1},8,["modelValue"]),u(O,{style:{"margin-left":"20px"},onClick:oe},{default:p((()=>l[5]||(l[5]=[c("查询")]))),_:1})]),u(t,{ref:"cusTable12313",height:"calc(100vh - 340px)","row-key":"id",isPagination:!1,isHandle:!1,tableCols:le.value,tableData:re.value,onHandleCurrentChange:oe},null,8,["tableCols","tableData"])]),u(m,{title:"审核",style:{"margin-top":"1%",width:"100%"}}),u(ne,{ref_key:"formValidateRef",ref:te,rules:ie.value,model:ae,"label-width":"130px"},{default:p((()=>[u(J,{label:"审核状态：",prop:"status"},{default:p((()=>[u(B,{modelValue:ae.status,"onUpdate:modelValue":l[1]||(l[1]=e=>ae.status=e)},{default:p((()=>[u(L,{value:1,label:"通过"}),u(L,{value:2,label:"驳回"})])),_:1},8,["modelValue"])])),_:1}),u(J,{label:"备注：",prop:"remark"},{default:p((()=>[u(Q,{modelValue:ae.remark,"onUpdate:modelValue":l[2]||(l[2]=e=>ae.remark=e),type:"textarea",rows:3,placeholder:"请输入备注"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])]})),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-8483e7d1"]]);export{I as default};
