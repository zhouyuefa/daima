import{_ as e,x as a,f as l,g as r,ah as t,o as u,c as s,d,w as i,a as o,J as n,K as p,L as m,e as _,t as c,l as v,F as b,i as h,j as g,A as w,ad as y,ae as f,D as V,a3 as k,a4 as x,a5 as z,ag as C,y as j}from"./index-BdR_P0jW.js";/* empty css                */import U from"./carForm-CJ6q5Sh0.js";import{d as O}from"./dateFormater-BlBTgtQf.js";import{E as Y}from"./index-C5ggMqbd.js";const L={class:"mb20"},S=e(Object.assign({name:"ordermanager/private/carOrderList"},{__name:"carOrderList",setup(e){const{CHAT_TYPE:S}=C,T=a(),A=l([]),D=l(!1),E=r({});l([]);const F=l([]),H=l({parent_order_no:"",order_no:"",order_type:"",admin_user_id:"",driver_user_id:"",customer_mobile:"",status:"",user_id:""});r([{value:0,label:"全部"},{value:1,label:"正常"},{value:2,label:"注销"},{value:3,label:"黑名单"}]);const P=l({page:1,page_size:20,total:0}),G=l([{label:"全部",value:"all"},{label:"待付款",value:"-1"},{label:"待接单",value:"0"},{label:"待服务",value:"1"},{label:"服务中",value:"service"},{label:"已到达",value:"5"},{label:"已完成",value:"6"},{label:"已取消",value:"7"}]),I=l([]),M=async()=>{const e=await g("/admin/order_car/index/lists",{parent_order_no:H.value.parent_order_no,order_no:H.value.order_no,customer_mobile:H.value.customer_mobile,status:H.value.status,order_type:H.value.order_type,admin_user_id:H.value.admin_user_id,driver_user_id:H.value.driver_user_id,user_id:H.value.user_id,page:P.value.page,page_size:P.value.page_size});e&&(A.value=(null==e?void 0:e.list)||[],P.value=(null==e?void 0:e.page)||{})},q=async()=>{const e=await g("/admin/drivers/audit_success");F.value=e||[]},J=async(e,a)=>{const l=await g("/admin/im/chat/organize",{id:e,other_type:a});l&&T.push({path:"/chat/conversation/message",query:{id:l.im_user_id,chatType:S.SINGLE,nickname:"driver"===a?l.sur+"师傅":l.nickname,userType:"driver"===a?"1":"customer"===a?"0":"2",toAvatarUrl:l.avatar_url}})},K=e=>{P.value.page_size=e,M()},N=e=>{P.value.page=e,M()},Z=e=>{(e=>{for(const a of Object.keys(e))delete e[a]})(E),Object.assign(E,e),D.value=!0},$=async()=>{M()};return(async()=>{M(),q(),(async()=>{const e=await j("/admin/users/index/lists",{page:1,page_size:99999});e&&(I.value=(null==e?void 0:e.lists.list)||[])})()})(),(e,a)=>{const l=w,r=y,g=f,C=V,j=k,S=x,T=z,F=Y,q=t("hasPermi");return u(),s("div",null,[d(F,null,{header:i((()=>a[9]||(a[9]=[o("span",null,"专车订单列表",-1)]))),default:i((()=>[o("div",L,[d(l,{modelValue:H.value.parent_order_no,"onUpdate:modelValue":a[0]||(a[0]=e=>H.value.parent_order_no=e),style:{width:"200px"},placeholder:"主订单编号",clearable:""},null,8,["modelValue"]),d(l,{modelValue:H.value.order_no,"onUpdate:modelValue":a[1]||(a[1]=e=>H.value.order_no=e),class:"ml30",style:{width:"200px"},placeholder:"子订单号",clearable:"","value-on-clear":""},null,8,["modelValue"]),d(l,{modelValue:H.value.customer_mobile,"onUpdate:modelValue":a[2]||(a[2]=e=>H.value.customer_mobile=e),class:"ml30",style:{width:"180px"},placeholder:"手机号",clearable:"","value-on-clear":""},null,8,["modelValue"]),d(g,{class:"ml30",modelValue:H.value.status,"onUpdate:modelValue":a[3]||(a[3]=e=>H.value.status=e),placeholder:"状态",style:{width:"180px"},clearable:""},{default:i((()=>[(u(!0),s(n,null,p(G.value,(e=>(u(),m(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),d(g,{class:"ml30",modelValue:H.value.user_id,"onUpdate:modelValue":a[4]||(a[4]=e=>H.value.user_id=e),placeholder:"选择用户",style:{width:"200px"},clearable:"",filterable:""},{default:i((()=>[(u(!0),s(n,null,p(I.value,(e=>(u(),m(r,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),d(C,{class:"ml30",type:"primary",onClick:a[5]||(a[5]=e=>{M()})},{default:i((()=>a[10]||(a[10]=[_("查询")]))),_:1})]),d(S,{data:A.value,"row-key":"id","default-expand-all":"",class:"mt5"},{default:i((()=>[d(j,{prop:"user_id",label:"用户id","min-width":"80"}),d(j,{prop:"order.order_no",label:"主订单编号","min-width":"180"}),d(j,{prop:"order_no",label:"子订单号","min-width":"180"}),d(j,{prop:"customer_name",label:"乘车人","min-width":"120"}),d(j,{prop:"customer_mobile",label:"用户手机","min-width":"120"}),d(j,{prop:"total_price",label:"总价格","min-width":"120"}),d(j,{prop:"order_price_c",label:"汽车公司价格","min-width":"120"}),d(j,{label:"航班号","min-width":"120"},{default:i((({row:e})=>[o("span",null,c(e.flight_no||"--"),1)])),_:1}),d(j,{label:"出发城市","min-width":"120"},{default:i((({row:e})=>[o("span",null,c(e.open_city||"--"),1)])),_:1}),d(j,{label:"上车点","min-width":"120"},{default:i((({row:e})=>[o("span",null,c(e.on_point||"--"),1)])),_:1}),d(j,{label:"下车点","min-width":"120"},{default:i((({row:e})=>[o("span",null,c(e.off_point||"--"),1)])),_:1}),d(j,{prop:"step_name",label:"状态","min-width":"100"}),d(j,{label:"用车时间","min-width":"160"},{default:i((({row:e})=>[o("span",null,c(v(O)("YYYY-MM-DD HH:mm:ss",e.use_time)),1)])),_:1}),d(j,{prop:"created_at",label:"下单时间","min-width":"160"}),d(j,{label:"详情",align:"center",width:"130"},{default:i((({row:e})=>[b((u(),m(C,{type:"primary",onClick:a=>Z(e)},{default:i((()=>a[11]||(a[11]=[_("详情")]))),_:2},1032,["onClick"])),[[q,["admin/order_car/detail"]]])])),_:1}),d(j,{label:"操作",align:"center",width:"230"},{default:i((({row:e})=>[0!==e.driver_user_id?(u(),m(C,{key:0,type:"primary",plain:"",onClick:a=>J(e.id,"driver")},{default:i((()=>a[12]||(a[12]=[_("联系司机")]))),_:2},1032,["onClick"])):h("",!0),d(C,{type:"warning",plain:"",onClick:a=>J(e.id,"customer")},{default:i((()=>a[13]||(a[13]=[_("联系乘客")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),d(T,{background:"",layout:"total, sizes, prev, pager, next, ->,jumper","current-page":P.value.page,"onUpdate:currentPage":a[6]||(a[6]=e=>P.value.page=e),"page-size":P.value.page_size,"onUpdate:pageSize":a[7]||(a[7]=e=>P.value.page_size=e),total:P.value.total,class:"ml10 mt10",onSizeChange:K,onCurrentChange:N},null,8,["current-page","page-size","total"])])),_:1}),d(U,{modelValue:D.value,"onUpdate:modelValue":a[8]||(a[8]=e=>D.value=e),data:E,onSubmit:$},null,8,["modelValue","data"])])}}}),[["__scopeId","data-v-26313c12"]]);export{S as default};
