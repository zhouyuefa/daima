import{f as e,y as a,g as l,T as t,S as s,r as n,o as i,c as o,a as r,d as u,w as d,e as p,t as h,aw as c,D as m,aa as b}from"./index-BdR_P0jW.js";/* empty css                */import v from"./shopTypeForm-Bv9EG8LB.js";import{E as g}from"./index-C5CR2e01.js";import"./dialogComp-DpPpTGA3.js";import"./index-DIDL6cCO.js";/* empty css                    */import"./index-TSZus3Mb.js";const y={class:"boxElMain"},f={class:"box boxFlex"},x={class:"dialog-footer"},w=Object.assign({name:"ShopTypeList"},{__name:"index",setup(w){const _=e({getList:"/admin/merchant/type/tree_list",getDetail:"/admin/merchant/type/detail"}),j=e([{label:"全部",value:"all"},{label:"启用",value:"1"},{label:"禁用",value:"2"}]),D=e([{type:"Input",label:"类型名称",prop:"name",placeholder:"请输入类型名称",width:"180px"},{type:"Select",label:"状态",prop:"status",width:"180px",options:j,placeholder:"请选择状态"}]),C=e({name:"",status:"all",parent_key:"all"}),k=e([{label:"查 询",icon:"Search",auth:"admin/merchant/type/tree_list",handle:()=>F()},{label:"重置",auth:"admin/merchant/type/tree_list",handle:()=>L()},{label:"排序",popover:!0}]),W=e([{label:"新增",icon:"Plus",auth:"admin/merchant/type/save_submit",handle:()=>P()}]),H=e([]),O=e({page:1,page_size:20}),E=e([{label:"ID",prop:"id",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"Key",prop:"key",align:"center",type:"string",sortable:!1,minWidth:"150",show:!0},{label:"类型名称",prop:"name",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"排序",prop:"sort",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"图标",prop:"file_url",align:"center",type:"image",imgWidth:"35px",sortable:!1,minWidth:"80",show:!0},{label:"url",prop:"link",align:"center",type:"string",sortable:!1,minWidth:"220",show:!0},{label:"状态",prop:"status_text",align:"center",type:"string",sortable:!1,minWidth:"110",show:!0},{label:"操作",minWidth:"160",type:"button",show:!0,fixed:"right",align:"center",btnList:[{labelTextFn:e=>(e=>1===e.status?"禁用":"启用")(e),typeFn:e=>(e=>1===e.status?"danger":"success")(e),auth:"admin/merchant/type/update_status",handle:(e,a,l,t,s)=>U(e,a)},{label:"编辑",type:"primary",auth:"admin/merchant/type/save_submit",handle:(e,a,l,t,s)=>V(e,a)}]}]),F=()=>{O.value.page=1,z()},T=e=>{for(const a of Object.keys(e))delete e[a]},V=(e,l,t,s,n)=>{(async e=>{const l=await a(_.value.getDetail,{id:e});l&&(T(A),S.value=!0,R.value="edit",Object.assign(A,l))})(l.id)},L=()=>{T(C.value),O.value.page=1,O.value.page_size=20,C.value.status="all",C.value.parent_key="all",z()},R=e(""),S=e(!1),P=()=>{T(A),S.value=!0,R.value="add"},z=async()=>{const e=await a(_.value.getList,{...O.value,...C.value});if(e&&(H.value=[],H.value.splice(0),e.length>0))for(let a=0;a<e.length;a++){let l=e[a];H.value.push(l)}},A=l({});t.on("getCheckData",(e=>{(e=>{const a=[];e.list.forEach((e=>{a.push(e.label)})),E.value.sort(((e,l)=>"操作"===e.label?1:a.indexOf(e.label)-a.indexOf(l.label))),E.value=E.value.map((a=>e.data.includes(a.label)||"操作"===a.label?{...a,show:!0}:{...a,show:!1}))})(e)})),s((()=>{z()}));const I=e(!1),U=(e,a,l,t,s)=>{T(A),Object.assign(A,a),I.value=!0},K=async()=>{let e={id:A.id};await a("/admin/merchant/type/update_status",e)&&(z(),I.value=!1)},M=e=>{"closeDialog"===e?(T(A),S.value=!1):"closeDialogAndRefresh"===e&&(S.value=!1,z())};return(e,a)=>{const l=c,t=n("cusTable"),s=g,w=m,_=b;return i(),o("div",y,[r("div",f,[u(s,null,{default:d((()=>[u(l,{searchForm:D.value,searchData:C.value,searchHandleRight:W.value,searchHandle:k.value,tableCols:E.value,onHandleEnterSearch:F,onHandleReset:L},null,8,["searchForm","searchData","searchHandleRight","searchHandle","tableCols"]),u(t,{ref:"cusTable",height:"calc(100vh - 180px)","row-key":"id",isPagination:!0,isHandle:!0,tableCols:E.value,tableData:H.value,tablePage:O.value,defaultExpandAll:!1,onHandleCurrentChange:z},null,8,["tableCols","tableData","tablePage"])])),_:1})]),u(v,{modelValue:S.value,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value=e),data:A,addOrEdit:R.value,onRefreshList:M},null,8,["modelValue","data","addOrEdit"]),u(_,{modelValue:I.value,"onUpdate:modelValue":a[2]||(a[2]=e=>I.value=e),title:"提示",width:"500"},{footer:d((()=>[r("div",x,[u(w,{onClick:a[1]||(a[1]=e=>I.value=!1)},{default:d((()=>a[3]||(a[3]=[p("取消")]))),_:1}),u(w,{type:"primary",onClick:K},{default:d((()=>a[4]||(a[4]=[p(" 确定 ")]))),_:1})])])),default:d((()=>[r("span",null,"确定要"+h(1===A.status?"禁用":"启用")+"该类型吗",1)])),_:1},8,["modelValue"])])}}});export{w as default};
