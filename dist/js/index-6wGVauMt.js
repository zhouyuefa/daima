import{_ as e,x as a,f as l,g as t,ah as s,o as n,c as i,d as o,w as u,a as p,J as d,K as r,L as g,e as m,t as v,F as c,j as _,ak as y,c0 as b,N as f,b_ as h,a3 as x,D as w,a4 as z,a5 as C}from"./index-BdR_P0jW.js";/* empty css                */import{E as j}from"./index-C5ggMqbd.js";const V={class:"mb20"},k={class:"mb20"},U={class:"RecordsBg mb10"},q={class:"flex items-center"},D=e(Object.assign({name:"system/log/index"},{__name:"index",setup(e){const D=a();l(!1),t({});const P=l([]),S=l({log_type:"request"}),B=l(),E=t([{value:"request",label:"操作日志"},{value:"error",label:"错误日志"}]),F=l({page:1,page_size:20,total:0}),I=async()=>{const e=await _("/system/log/setting",{log_type:S.value.log_type});e&&(P.value=(null==e?void 0:e.file_list)||[],B.value=1==e.setting.log_is_open)},J=e=>{F.value.page_size=e,I()},K=e=>{F.value.page=e,I()},L=async()=>{await y("/system/log/setting",{setting:{log_is_open:B.value?1:0}})},N=()=>{I()};return(async()=>{I()})(),(e,a)=>{const l=b,t=f,_=h,y=x,I=w,O=z,R=C,T=j,Z=s("hasPermi");return n(),i("div",null,[o(T,null,{header:u((()=>a[4]||(a[4]=[p("span",null,"日志配置",-1)]))),default:u((()=>[p("div",V,[o(t,{modelValue:S.value.log_type,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value.log_type=e),onChange:N},{default:u((()=>[(n(!0),i(d,null,r(E,(e=>(n(),g(l,{label:e.label,value:e.value},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])]),p("div",k,[p("div",U,[a[5]||(a[5]=m(" 记录后台操作日志")),a[6]||(a[6]=p("br",null,null,-1)),m(" 只记录post请求的数据，内容包含请求数、结果数据。 "+v(B.value),1)]),p("div",q,[a[7]||(a[7]=p("div",null,"日志记录",-1)),o(_,{class:"ml20",modelValue:B.value,"onUpdate:modelValue":a[1]||(a[1]=e=>B.value=e),"active-text":"开启","inactive-text":"关闭",onChange:L},null,8,["modelValue"])])]),o(O,{data:P.value,"row-key":"id","default-expand-all":"",class:"no-log-table mt5"},{default:u((()=>[o(y,{prop:"file_name",label:"文件名称","min-width":"10"}),o(y,{prop:"file_size",label:"大小","min-width":"10"}),o(y,{prop:"file_path",label:"文件路径","min-width":"10"}),o(y,{label:"操作",align:"center",width:"220","min-width":"220"},{default:u((({row:e})=>[c((n(),g(I,{type:"primary",onClick:a=>(e=>{const a={file:e.file_name,time:(new Date).getTime()};D.push({name:"external",params:{url:"/system/log/detail"},query:a})})(e)},{default:u((()=>a[8]||(a[8]=[m("详情")]))),_:2},1032,["onClick"])),[[Z,["system/log/detail"]]])])),_:1})])),_:1},8,["data"]),o(R,{background:"",layout:"total, sizes, prev, pager, next, ->,jumper","current-page":F.value.page,"onUpdate:currentPage":a[2]||(a[2]=e=>F.value.page=e),"page-size":F.value.page_size,"onUpdate:pageSize":a[3]||(a[3]=e=>F.value.page_size=e),total:F.value.total,class:"ml10 mt10",onSizeChange:J,onCurrentChange:K},null,8,["current-page","page-size","total"])])),_:1})])}}}),[["__scopeId","data-v-8e48e576"]]);export{D as default};
