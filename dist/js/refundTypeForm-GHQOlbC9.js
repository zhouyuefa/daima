import{_ as e,R as t,g as a,h as r,f as l,o as s,L as n,y as d,H as i}from"./index-BdR_P0jW.js";import{d as o}from"./dialogComp-DpPpTGA3.js";import"./index-DIDL6cCO.js";/* empty css                    */import"./index-TSZus3Mb.js";const m=e({__name:"refundTypeForm",props:{modelValue:{type:Boolean,default:!1},data:{type:Object,default:()=>({id:"000000000"})},addOrEdit:{type:String,default:""}},emits:["submit","refreshList"],setup(e,{emit:m}){const u=m,c=e,p=t((()=>c.modelValue)),y=t((()=>("edit"===c.addOrEdit?"编辑":"新增")+"退款规则")),g=t((()=>c.data.id)),h=a({}),f=e=>{for(const t of Object.keys(e))delete e[t]};r((()=>c.modelValue),(async e=>{e&&!g.value&&f(h)})),r(g,(async e=>{if(e??0){let e=JSON.parse(JSON.stringify(c.data));Object.assign(h,e)}else f(h)}));const _=l([]);(async()=>{const e=await d("/admin/merchant/type/tree_list");_.value=(null==e?void 0:e.map((e=>{var t;return(null==(t=e.children)?void 0:t.length)>0&&(e.children=e.children.map((e=>({value:e.key,label:e.name})))),{value:e.key,label:e.name,children:e.children}})))||[]})();const v=l([]);(async()=>{const e=await d("/admin/merchant/order_refund_config/select_list",{merchant_type:"common"});v.value=(null==e?void 0:e.map((e=>({value:e.key,label:e.name,...e}))))||[]})();const b=a({merchant_type:[{required:!0,message:"请选择",trigger:["blur","change"]}],key:[{required:!0,message:"请输入",trigger:"blur"}],refund_rate:[{required:!0,message:"请输入",trigger:"blur"}],handle_rate:[{required:!0,message:"请输入",trigger:"blur"}],desc:[{required:!0,message:"请输入退款规则描述",trigger:"blur"}]}),O=l([{label:"类型名称:",type:"cascader",msg:"merchant_type",options:_,disabled:()=>"edit"==c.addOrEdit},{label:"退款规则:",type:"select",msg:"key",options:v,changeItems:["refund_rate","handle_rate","desc"],disabled:()=>"edit"==c.addOrEdit},{label:"退款比例:",type:"input",msg:"refund_rate"},{label:"退款手续费:",type:"input",msg:"handle_rate"},{label:"退款规则描述:",type:"input",msg:"desc"}]),j=async e=>{if(!e)return f(h),void u("refreshList","closeDialog");let t=JSON.parse(JSON.stringify(e));"object"==typeof(null==e?void 0:e.merchant_type)&&1===(null==e?void 0:e.merchant_type.length)?t.merchant_type=null==e?void 0:e.merchant_type[0]:"string"==typeof(null==e?void 0:e.merchant_type)?t.merchant_type=null==e?void 0:e.merchant_type:"object"==typeof(null==e?void 0:e.merchant_type)&&(t.merchant_type=null==e?void 0:e.merchant_type[1]);await d("/admin/merchant/order_refund_config/edit_save",t)&&(i.success("保存成功"),f(h),u("refreshList","closeDialogAndRefresh"))};return(e,t)=>(s(),n(o,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),formList:O.value,formData:h,rules:b,title:y.value,width:"550px",onSubmit:j},null,8,["modelValue","formList","formData","rules","title"]))}},[["__scopeId","data-v-fd30601b"]]);export{m as default};
