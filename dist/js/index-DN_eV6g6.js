import{f as e,g as a,ai as t,y as l,H as n,T as i,S as r,r as s,o,c as p,a as d,d as c,w as h,av as b,aw as u,j as g}from"./index-BdR_P0jW.js";/* empty css                */import{E as m}from"./index-C5CR2e01.js";const y={class:"boxElMain"},_={class:"box boxFlex"},v={__name:"index",setup(v){e({getList:"/cozy_hire_admin/order_car/pool_list",exportExcel:"/info/loginLog/export"}),e([]);const w=e({admin_user_id:"",bill_date:[]}),f=a([{value:"all",label:"全部"},{value:"1",label:"接机"},{value:"2",label:"送机"},{value:"3",label:"包车"}]),x=e([]);(async()=>{(async()=>{const e=await g("/cozy_hire_admin/driver/index/lists",{page:1,page_size:1e3});e&&(x.value=(null==e?void 0:e.lists.list.map((e=>({label:e.realname,value:e.user_id}))))||[])})()})();const W=e([{type:"DateTimeRange",label:"出账日期",prop:"bill_date",placeholder:"请选择",options:f,width:"280px"},{type:"Input",label:"汽车公司",prop:"admin_user_id"}]),S=e({order_type:"all",use_time:""}),C=e([{label:"查 询",icon:"Search",handle:()=>P()}]),H=e([]),z=e([]),L=e({pageCurrent:1,pageSize:10,totalPages:0,params:{}}),R=e([{label:"公司",prop:"admin_user_name",align:"center",type:"string",sortable:!1,minWidth:"200",show:!0},{label:"订单数",prop:"order_number",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0},{label:"含税总价格（客户消费总额）",type:"Secondary",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0,propSec:[{label:"日币/wance",prop:"total_price",align:"center",type:"string",sortable:!1,minWidth:"200",show:!0},{label:"人民币",prop:"total_price_r",align:"center",type:"string",sortable:!1,minWidth:"200",show:!0}]},{label:"国内3%增值税",prop:"zengzhishui",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0},{label:"平台留存占总价比例",prop:"plate_save_rate",align:"center",type:"percentage",sortable:!1,minWidth:"160",show:!0},{label:"平台最终留存额",type:"Secondary",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0,propSec:[{label:"日币",prop:"plate_price",align:"center",type:"string",sortable:!1,minWidth:"200",show:!0}]},{label:"汽车公司结算额占总价比例",prop:"company_rate",align:"center",type:"percentage",sortable:!1,minWidth:"160",show:!0},{label:"日本汽车公司结算金额（内含消费税）",type:"Secondary",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0,propSec:[{label:"日币/wance",prop:"company_price",align:"center",type:"string",sortable:!1,minWidth:"200",show:!0},{label:"人民币",prop:"company_price_r",align:"center",type:"string",sortable:!1,minWidth:"200",show:!0}]},{label:"订单价格TN",type:"Secondary",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0,propSec:[{label:"日币",prop:"order_price",align:"center",type:"string",sortable:!1,minWidth:"200",show:!0}]},{label:"平台的利润额（扣除增值税）",type:"Secondary",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0,propSec:[{label:"日币",prop:"plate_profit",align:"center",type:"string",sortable:!1,minWidth:"200",show:!0}]},{label:"平台最终利润率",prop:"plate_profit_rate",align:"center",type:"percentage",sortable:!1,minWidth:"200",show:!0},{label:"领收书",minWidth:"110",type:"button",show:!0,fixed:"right",align:"center",btnList:[{hide:e=>O(e),label:"查看",type:"text",auth:"['admin/version/detail']",handle:(e,a)=>T(a)},{hide:e=>O(e),label:"下载",type:"text",auth:"['admin/version/detail']",handle:(e,a)=>k(a)}]},{label:"操作",minWidth:"110",type:"button",show:!0,fixed:"right",align:"center",btnList:[{hide:e=>j(e),label:"结算",type:"primary",auth:"['admin/version/detail']",handle:(e,a,t,l,n)=>E(a)}]}]),O=e=>!e.file_url,j=e=>1!==e.status,D=(e,a=!0)=>{const t=new XMLHttpRequest;t.open("get",e),t.responseType="blob",t.send(),t.onload=function(){if(200===this.status||304===this.status){if("msSaveOrOpenBlob"in navigator)return void navigator.msSaveOrOpenBlob(this.response,name);const t=URL.createObjectURL(this.response);if(a){const a=document.createElement("a");a.style.display="none",a.href=t,a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)}else window.open(t,e)}}},T=e=>{D(e.file_url,!1)},k=e=>{D(e.file_url)},E=async e=>{t.confirm("是否结算该公司的对账单？").then((async()=>{await l("/admin/company_withdraw/audit",{id:e.id,status:"2"})&&(n({type:"success",message:"操作成功"}),B())})).catch((()=>{}))},P=()=>{L.value.pageCurrent=1,B()};e(!1);const U=()=>{b.clearObj(S),L.value.pageCurrent=1,B()};e(!1);const F=e({page:1,page_size:20,total:0}),B=async()=>{const e=await l("/admin/company_withdraw/withdraw_list",{page:F.value.page,page_size:F.value.page_size,bill_date:w.value.bill_date,admin_user_id:w.value.admin_user_id,status:"all"});e&&(z.value=(null==e?void 0:e.list)||[])};a({}),i.on("getCheckData",(e=>{getCheckData(e)}));const M=e([]);return i.on("sortChange",(({prop:e,order:a})=>{let t="";t=-1!==e.indexOf("_text")?e.replace("_text",""):e,M.value=M.value.filter((e=>!e[t])),"descending"===a?M.value.push({[t]:"desc"}):"ascending"===a?M.value.push({[t]:"asc"}):M.value=M.value.filter((e=>!e[t])),B()})),r((()=>{B()})),(e,a)=>{const t=u,l=s("cusTable"),n=m;return o(),p("div",y,[d("div",_,[c(n,null,{default:h((()=>[c(t,{searchForm:W.value,searchData:S.value,searchHandleRight:H.value,searchHandle:C.value,tableCols:R.value,onHandleEnterSearch:P,onHandleReset:U},null,8,["searchForm","searchData","searchHandleRight","searchHandle","tableCols"]),c(l,{ref:"cusTable",height:"calc(100vh - 240px)","row-key":"test_admin_user_id",isPagination:!0,isHandle:!0,tableCols:R.value,tableData:z.value,tablePage:L.value,SecondaryHead:"",onHandleCurrentChange:B},null,8,["tableCols","tableData","tablePage"])])),_:1})])])}}};export{v as default};
