import{_ as e,x as a,f as l,g as t,a1 as o,o as s,c as i,d as r,w as d,a as n,J as p,K as u,L as m,e as _,t as b,l as c,i as v,y as w,j as h,ad as y,ae as g,A as f,D as x,a3 as z,a4 as V,a5 as j}from"./index-BdR_P0jW.js";/* empty css                */import k from"./ordersForm-B-BJ6G_-.js";import{d as T}from"./dateFormater-BlBTgtQf.js";import{E as C}from"./index-C5ggMqbd.js";const L={class:"mb20"},U=e(Object.assign({name:"ordermanager/orders/index"},{__name:"index",setup(e){a();const U=l([]),S=l(!1),D=t({}),E=l({order_type:"",order_no:"",user_id:""}),Y=o({1:"约车",2:"旅游"}),F=o({1:"接机",2:"送机",3:"保姆车"}),N=o({0:"待支付",1:"已支付"}),H={typeList:Y,statusList:N},I=t([{value:0,label:"全部"},{value:1,label:"约车"},{value:2,label:"旅游"}]),M=l({page:1,page_size:20,total:0}),R=l([]);(async()=>{const e=await w("/admin/users/index/lists",{page:1,page_size:99999});e&&(R.value=(null==e?void 0:e.lists.list)||[])})();const A=l(null),J=e=>e.id,K=l([]),O=async(e,a)=>{if(K.value=a,a.some((a=>a.id===e.id))){const a=await h("/admin/orders/sub_lists/"+e.id);e.subTable=a.lists.list}},P=async()=>{const e=await h("/admin/orders/index/lists",{order_type:E.value.order_type,order_no:E.value.order_no,user_id:E.value.user_id,page:M.value.page,page_size:M.value.page_size});e&&(U.value=(null==e?void 0:e.lists.list)||[],M.value=(null==e?void 0:e.lists.page)||{})};P();const Z=e=>{M.value.page_size=e,P()},$=e=>{M.value.page=e,P()},q=async(e,a)=>{if(e.is_comment&&a.some((a=>a.id===e.id))){const a=await h("/admin/orders/evaluate_info/"+e.id),{content:l,score_text:t}=a.info;e.comment=l,e.commentScore=t}},B=async()=>{P()};return(e,a)=>{const l=y,t=g,o=f,w=x,h=z,G=V,Q=j,W=C;return s(),i("div",null,[r(W,null,{header:d((()=>a[7]||(a[7]=[n("span",null,"订单列表",-1)]))),default:d((()=>[n("div",L,[r(t,{modelValue:E.value.order_type,"onUpdate:modelValue":a[0]||(a[0]=e=>E.value.order_type=e),placeholder:"订单类型",style:{width:"120px"}},{default:d((()=>[(s(!0),i(p,null,u(I,(e=>(s(),m(l,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),r(o,{class:"ml30",modelValue:E.value.order_no,"onUpdate:modelValue":a[1]||(a[1]=e=>E.value.order_no=e),style:{width:"200px"},placeholder:"主订单编号",clearable:""},null,8,["modelValue"]),r(t,{class:"ml30",modelValue:E.value.user_id,"onUpdate:modelValue":a[2]||(a[2]=e=>E.value.user_id=e),placeholder:"选择用户",style:{width:"200px"},clearable:"",filterable:""},{default:d((()=>[(s(!0),i(p,null,u(R.value,(e=>(s(),m(l,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),r(w,{class:"ml30",type:"primary",onClick:a[3]||(a[3]=e=>(()=>{for(const e of K.value)A.value.toggleRowExpansion(e,!1);M.value.page=1,P()})())},{default:d((()=>a[8]||(a[8]=[_("查询")]))),_:1})]),r(G,{data:U.value,"row-key":"id",class:"mt5",onExpandChange:O,ref_key:"outTableRef",ref:A},{default:d((()=>[r(h,{type:"expand"},{default:d((e=>[r(G,{data:e.row.subTable,border:"",class:"sub-table","row-key":J,onExpandChange:q},{default:d((()=>[r(h,{prop:"order_type",label:"类型","min-width":"10"},{default:d((({row:e})=>[n("span",null,b(c(F)[e.order_type]||"--"),1)])),_:1}),r(h,{prop:"status_text",label:"状态","min-width":"10"}),r(h,{prop:"flight_no",label:"航班号","min-width":"10"}),r(h,{prop:"open_city",label:"城市","min-width":"10"}),r(h,{prop:"use_time",label:"用车时间","min-width":"10"},{default:d((({row:e})=>[_(b(c(T)("YYYY-MM-DD HH:mm:ss",e.use_time)),1)])),_:1}),r(h,{prop:"on_point",label:"上车点","min-width":"10"}),r(h,{prop:"off_point",label:"下车点","min-width":"10"}),r(h,{prop:"brand_name",label:"车辆品牌名称","min-width":"10"}),r(h,{prop:"style_name",label:"车辆品牌系列","min-width":"10"}),r(h,{prop:"type_name",label:"车辆类型名称","min-width":"10"}),r(h,{prop:"car_tabs_name",label:"车辆标签名称","min-width":"10"}),r(h,{prop:"seat_num",label:"座位数",width:"80"}),r(h,{prop:"customer_name",label:"客户姓名","min-width":"10"}),r(h,{prop:"customer_mobile",label:"客户电话","min-width":"10"}),r(h,{prop:"days",label:"包车天数",width:"80"}),r(h,{type:"expand",label:"评价",width:"90"},{default:d((({row:e})=>[e.is_comment?(s(),i(p,{key:0},[n("div",null,"评价内容："+b(e.comment),1),n("div",null,"评分："+b(e.commentScore),1)],64)):v("",!0)])),_:1})])),_:2},1032,["data"])])),_:1}),r(h,{prop:"id",label:"ID","min-width":"80",sortable:""}),r(h,{prop:"order_type",label:"类型","min-width":"100"},{default:d((({row:e})=>[n("span",null,b(H.typeList[e.order_type]||"--"),1)])),_:1}),r(h,{prop:"order_no",label:"订单编码","min-width":"180"}),r(h,{prop:"created_at",label:"下单时间","min-width":"160"}),r(h,{prop:"total_price",label:"总价格(TN)","min-width":"120"}),r(h,{prop:"order_price",label:"订单价格(TN)","min-width":"120"}),r(h,{prop:"tax_price",label:"消费税(TN)","min-width":"120"}),r(h,{prop:"rmb",label:"人民币总额(分)","min-width":"120"}),r(h,{prop:"exchange_rate",label:"汇率","min-width":"120"})])),_:1},8,["data"]),r(Q,{background:"",layout:"total, sizes, prev, pager, next, ->,jumper","current-page":M.value.page,"onUpdate:currentPage":a[4]||(a[4]=e=>M.value.page=e),"page-size":M.value.page_size,"onUpdate:pageSize":a[5]||(a[5]=e=>M.value.page_size=e),total:M.value.total,class:"ml10 mt10",onSizeChange:Z,onCurrentChange:$},null,8,["current-page","page-size","total"])])),_:1}),r(k,{modelValue:S.value,"onUpdate:modelValue":a[6]||(a[6]=e=>S.value=e),data:D,objType:{typeList:c(Y),statusList:c(N)},onSubmit:B},null,8,["modelValue","data","objType"])])}}}),[["__scopeId","data-v-5a21ee6f"]]);export{U as default};
