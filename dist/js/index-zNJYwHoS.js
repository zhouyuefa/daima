import{_ as e,f as a,y as l,g as t,T as s,S as i,r as n,o as r,c as o,a as p,d,w as u,t as c,e as h,aw as b,D as g,aa as m}from"./index-BdR_P0jW.js";/* empty css                */import{E as v}from"./index-C5CR2e01.js";const _={class:"boxElMain"},y={class:"box boxFlex"},w={style:{display:"flex"}},f={class:"js-box"},x={class:"js-box"},W={class:"js-box"},C={class:"dialog-footer"},j=e({__name:"index",setup(e){const j=a({getList:"/admin/user_bill/check_bill_lists"}),k=a([{type:"Input",label:"商户名称",prop:"name",placeholder:"请输入商户名称",width:"180px"},{type:"Input",label:"订单号",prop:"order_no",width:"180px",placeholder:"请输入订单号"},{type:"DateRange",label:"日期",prop:"created_at",placeholder:"请输入类型名称",width:"280px"}]),D=a({name:"",order_no:"",created_at:[]}),H=a([{label:"查 询",icon:"Search",auth:"admin/user_bill/check_bill_lists",handle:()=>T()},{label:"重置",auth:"admin/user_bill/check_bill_lists",handle:()=>I()},{label:"排序",popover:!0}]),V=a([]),P=a([]),S=a({page:1,page_size:20,totalPages:0}),E=a([{label:"序号",prop:"id",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"商户名称",prop:"merchant_info",subProp:"name",align:"center",type:"object",sortable:!1,minWidth:"80",show:!0},{label:"流水单号",prop:"bill_date",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"订单号",prop:"order_num",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"订单金额（TN）",prop:"total_price",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"积分发放比例",prop:"vat_price",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"商户发放积分",prop:"plate_rate",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"平台用户积分分成比例",prop:"plate_price",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"用户获取积分",prop:"merchant_rate",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"用户账号",prop:"merchant_price",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"用户昵称",prop:"order_price",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"平台实际剩余积分",prop:"plate_profit",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"创建时间",prop:"audit_date",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0}]),F=a([]),R=a(!1),T=()=>{S.value.page=1,z()},I=()=>{(e=>{for(const a of Object.keys(e))delete e[a]})(D.value),S.value.page=1,S.value.page_size=20,z()},O=a({}),z=async()=>{const e=await l(j.value.getList,{...S.value,...D.value});if(e&&(P.value=[],S.value.total=e.page.total||0,P.value.splice(0),O.value=e.statistics,e.list.length>0))for(let a=0;a<e.list.length;a++){let l=e.list[a];P.value.push(l)}},L=t({});s.on("getCheckData",(e=>{(e=>{const a=[];e.list.forEach((e=>{a.push(e.label)})),E.value.sort(((e,l)=>"操作"===e.label?1:a.indexOf(e.label)-a.indexOf(l.label))),E.value=E.value.map((a=>e.data.includes(a.label)||"操作"===a.label?{...a,show:!0}:{...a,show:!1}))})(e)})),i((()=>{z()}));const M=a(!1),U=async()=>{let e={id:L.id};await l("/admin/merchant/type/update_status",e)&&(z(),M.value=!1)};return(e,a)=>{const l=b,t=n("cusTable"),s=v,i=n("DetailForm"),j=g,N=m;return r(),o("div",_,[p("div",y,[d(s,null,{default:u((()=>[d(l,{searchForm:k.value,searchData:D.value,searchHandleRight:V.value,searchHandle:H.value,tableCols:E.value,onHandleEnterSearch:T,onHandleReset:I},null,8,["searchForm","searchData","searchHandleRight","searchHandle","tableCols"]),p("div",w,[p("div",f,[a[3]||(a[3]=p("p",null,"平台接收积分总计",-1)),p("p",null,c(O.value.may_price_r),1)]),p("div",x,[a[4]||(a[4]=p("p",null,"用户获取积分总计",-1)),p("p",null,c(O.value.await_price),1)]),p("div",W,[a[5]||(a[5]=p("p",null,"平台剩余积分总计",-1)),p("p",null,c(O.value.total_price),1)])]),d(t,{ref:"cusTable",height:"calc(100vh - 320px)","row-key":"id",isPagination:!0,isHandle:!0,tableCols:E.value,tableData:P.value,tablePage:S.value,onHandleCurrentChange:z},null,8,["tableCols","tableData","tablePage"])])),_:1})]),d(i,{modelValue:R.value,"onUpdate:modelValue":a[0]||(a[0]=e=>R.value=e),data:F.value,onSubmit:e.refreshMenu},null,8,["modelValue","data","onSubmit"]),d(N,{modelValue:M.value,"onUpdate:modelValue":a[2]||(a[2]=e=>M.value=e),title:"提示",width:"500"},{footer:u((()=>[p("div",C,[d(j,{onClick:a[1]||(a[1]=e=>M.value=!1)},{default:u((()=>a[6]||(a[6]=[h("取消")]))),_:1}),d(j,{type:"primary",onClick:U},{default:u((()=>a[7]||(a[7]=[h(" 确定 ")]))),_:1})])])),default:u((()=>[p("span",null,"确定要"+c(1===L.status?"禁用":"启用")+"该类型吗",1)])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-26c36d37"]]);export{j as default};
