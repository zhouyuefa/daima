import{_ as e,f as a,o as l,c as t,d as i,w as n,a as s,J as d,K as o,L as r,e as u,i as p,j as m,y as c,ai as _,H as v,am as g,ad as f,ae as b,D as y,a3 as w,a4 as h,a5 as k}from"./index-BdR_P0jW.js";/* empty css                */import{E as z}from"./index-C5ggMqbd.js";const C={class:"mb20"},j={key:1},x={key:1},U=e(Object.assign({name:"financemanager/driver_withdraw/index"},{__name:"_old",setup(e){const U=a([]),O=a([]),D=a({admin_user_id:"",bill_date:[]}),L=a({page:1,page_size:20,total:0}),V=async()=>{const e=await c("/admin/company_withdraw/lists",{page:L.value.page,page_size:L.value.page_size,bill_date:D.value.bill_date,admin_user_id:D.value.admin_user_id,status:"all"});e&&(U.value=(null==e?void 0:e.list)||[],L.value=(null==e?void 0:e.page)||{})};V(),(async()=>{var e;const a=await m("/admin/companies/index/lists",{page_size:9999,page:1});O.value=(null==(e=null==a?void 0:a.lists)?void 0:e.list)||[]})();const R=e=>{L.value.page_size=e,V()},H=e=>{L.value.page=e,V()},S=(e,a=!0)=>{const l=new XMLHttpRequest;l.open("get",e.file_url),l.responseType="blob",l.send(),l.onload=function(){if(200===this.status||304===this.status){if("msSaveOrOpenBlob"in navigator)return void navigator.msSaveOrOpenBlob(this.response,name);const l=URL.createObjectURL(this.response);if(a){const a=document.createElement("a");a.style.display="none",a.href=l,a.download=e.file_name,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(l)}else window.open(l,e.file_name)}}};return(e,a)=>{const m=g,Y=f,M=b,B=y,E=w,I=h,T=k,q=z;return l(),t("div",null,[i(q,null,{header:n((()=>a[5]||(a[5]=[s("span",null,"公司对账单",-1)]))),default:n((()=>[s("div",C,[i(m,{modelValue:D.value.bill_date,"onUpdate:modelValue":a[0]||(a[0]=e=>D.value.bill_date=e),type:"daterange","range-separator":"至","start-placeholder":"开始出账日期","end-placeholder":"结束出账日期","value-format":"YYYY-MM-DD HH:mm:ss","default-time":[new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)]},null,8,["modelValue","default-time"]),i(M,{modelValue:D.value.admin_user_id,"onUpdate:modelValue":a[1]||(a[1]=e=>D.value.admin_user_id=e),placeholder:"汽车公司",style:{width:"280px"},class:"ml30",clearable:""},{default:n((()=>[(l(!0),t(d,null,o(O.value,(e=>(l(),r(Y,{key:e.admin_user_id,label:e.real_name,value:e.admin_user_id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),i(B,{class:"ml30",type:"primary",onClick:a[2]||(a[2]=e=>(L.value.page=1,void V()))},{default:n((()=>a[6]||(a[6]=[u("查询")]))),_:1})]),i(I,{data:U.value,"row-key":"id",class:"mt5"},{default:n((()=>[i(E,{prop:"id",label:"ID","min-width":"10",sortable:"",width:"100"}),i(E,{prop:"bill_no",label:"账单编号",width:"300"}),i(E,{prop:"bill_date",label:"出账日",width:"120"}),i(E,{prop:"admin.real_name",label:"公司名称","min-width":"100"}),i(E,{prop:"price",label:"结算金额(内含消费税TN)","min-width":"170"}),i(E,{prop:"status_text",label:"状态","min-width":"100"}),i(E,{prop:"audit_date",label:"打款时间","min-width":"160"}),i(E,{label:"领收书","min-width":"160",align:"center"},{default:n((({row:e})=>{var s;return[(null==(s=e.file)?void 0:s.file_url)?(l(),t(d,{key:0},[i(B,{onClick:a=>(e=>{S(e.file,!1)})(e),type:"primary",link:""},{default:n((()=>a[7]||(a[7]=[u(" 查看 ")]))),_:2},1032,["onClick"]),i(B,{onClick:a=>(e=>{S(e.file)})(e),type:"primary",link:""},{default:n((()=>a[8]||(a[8]=[u(" 下载 ")]))),_:2},1032,["onClick"])],64)):(l(),t("span",j,"-"))]})),_:1}),i(E,{label:"操作","min-width":"100",align:"center"},{default:n((({row:e})=>{var i;return[(null==(i=e.file)?void 0:i.file_url)?(l(),t(d,{key:0},[1===e.status?(l(),r(B,{key:0,onClick:a=>(async e=>{_.confirm("是否结算该公司的对账单？").then((async()=>{await c("/admin/company_withdraw/audit",{id:e.id,status:"2"})&&(v({type:"success",message:"操作成功"}),V())})).catch((()=>{}))})(e),type:"primary",link:""},{default:n((()=>a[9]||(a[9]=[u(" 结算 ")]))),_:2},1032,["onClick"])):p("",!0)],64)):(l(),t("span",x,"-"))]})),_:1})])),_:1},8,["data"]),i(T,{background:"",layout:"total, sizes, prev, pager, next, ->,jumper","current-page":L.value.page,"onUpdate:currentPage":a[3]||(a[3]=e=>L.value.page=e),"page-size":L.value.page_size,"onUpdate:pageSize":a[4]||(a[4]=e=>L.value.page_size=e),total:L.value.total,class:"ml10 mt10",onSizeChange:R,onCurrentChange:H},null,8,["current-page","page-size","total"])])),_:1})])}}}),[["__scopeId","data-v-e9437c9e"]]);export{U as default};
