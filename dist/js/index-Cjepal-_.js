import{x as e,f as a,j as l,y as t,g as s,T as i,S as n,r,o,c as u,a as d,d as p,w as c,e as h,t as b,ag as v,aw as m,D as g,aa as _}from"./index-BdR_P0jW.js";/* empty css                */import{E as y}from"./index-C5CR2e01.js";const f={class:"boxElMain"},w={class:"box boxFlex"},x={class:"dialog-footer"},C={__name:"index",setup(C){const D=e(),{CHAT_TYPE:H}=v,k=a({getList:"/admin/customized/lists"});a([{label:"全部",value:"all"},{label:"启用",value:"1"},{label:"禁用",value:"2"}]);const T=a([{type:"Input",label:"用户ID",prop:"user_id",placeholder:"请输入类型名称",width:"180px"},{type:"Input",label:"手机号",prop:"mobile",placeholder:"请输入手机号",width:"180px"},{type:"DateRange",label:"提交时间",prop:"created_time",width:"280px"}]),W=a({user_id:"",mobile:"",created_time:""}),E=a([{label:"查 询",icon:"Search",handle:()=>S()},{label:"重置",handle:()=>z()},{label:"排序",popover:!0}]),j=a([]),I=a([]),P=a({page:1,page_size:20,totalPages:0}),L=a([{label:"编号",prop:"id",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"用户ID",prop:"user_id",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"用户名称",prop:"user_name",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"用户手机号",prop:"user_mobile",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"内容",prop:"content",align:"center",type:"string",sortable:!1,minWidth:"220",show:!0},{label:"提交时间",prop:"created_at",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0},{label:"操作",minWidth:"160",type:"button",show:!0,fixed:"right",align:"center",btnList:[{label:"在线回复",type:"primary",auth:"['admin/version/detail']",handle:(e,a,l,t,s)=>R(a)}]}]),R=async e=>{const a=await l("/admin/im/chat/user_info",{user_id:e.user_id});a&&D.push({path:"/chat/conversation/message",query:{id:a.im_user_id,chatType:H.SINGLE,nickname:a.nickname,userType:"0",toAvatarUrl:a.avatar_url}})},S=()=>{P.value.page=1,F()},z=()=>{(e=>{for(const a of Object.keys(e))delete e[a]})(W.value),P.value.page=1,P.value.page_size=20,W.value.status="all",W.value.parent_id="all",F()};a(!1);const F=async e=>{const a=await t(k.value.getList,{...P.value,...W.value});if(a&&(I.value=[],P.value.total=a.list.total||0,I.value.splice(0),a.list.length>0))for(let l=0;l<a.list.length;l++){let e=a.list[l];I.value.push(e)}},O=s({});i.on("getCheckData",(e=>{(e=>{const a=[];e.list.forEach((e=>{a.push(e.label)})),L.value.sort(((e,l)=>"操作"===e.label?1:a.indexOf(e.label)-a.indexOf(l.label))),L.value=L.value.map((a=>e.data.includes(a.label)||"操作"===a.label?{...a,show:!0}:{...a,show:!1}))})(e)})),n((()=>{F()}));const V=a(!1),A=async()=>{let e={id:O.id};await t("/admin/merchant/type/update_status",e)&&(F(),V.value=!1)};return(e,a)=>{const l=m,t=r("cusTable"),s=y,i=g,n=_;return o(),u("div",f,[d("div",w,[p(s,null,{default:c((()=>[p(l,{searchForm:T.value,searchData:W.value,searchHandleRight:j.value,searchHandle:E.value,tableCols:L.value,onHandleEnterSearch:S,onHandleReset:z},null,8,["searchForm","searchData","searchHandleRight","searchHandle","tableCols"]),p(t,{ref:"cusTable",height:"calc(100vh - 240px)","row-key":"id",isPagination:!0,isHandle:!0,tableCols:L.value,tableData:I.value,tablePage:P.value,onHandleCurrentChange:F},null,8,["tableCols","tableData","tablePage"])])),_:1})]),p(n,{modelValue:V.value,"onUpdate:modelValue":a[1]||(a[1]=e=>V.value=e),title:"提示",width:"500"},{footer:c((()=>[d("div",x,[p(i,{onClick:a[0]||(a[0]=e=>V.value=!1)},{default:c((()=>a[2]||(a[2]=[h("取消")]))),_:1}),p(i,{type:"primary",onClick:A},{default:c((()=>a[3]||(a[3]=[h(" 确定 ")]))),_:1})])])),default:c((()=>[d("span",null,"确定要"+b(1===O.status?"禁用":"启用")+"该类型吗",1)])),_:1},8,["modelValue"])])}}};export{C as default};
