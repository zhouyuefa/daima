import{O as e,r as a,o as s,c as n,K as t,J as l,L as u,w as r,d as i,P as o,i as c,a as d,t as m,l as f,z as v,_,v as p,x as h,u as x,Q as k,f as y,R as g,S as w,T as C,U as M,h as b,V as T,e as j,s as I,W as z,X as A,Y as E,Z as L,$ as q,a0 as B}from"./index-BdR_P0jW.js";import{E as P,a as R,b as U}from"./index-CkR9YSSV.js";import{u as D}from"./keepalive-JK8JSjvp.js";import{g as K}from"./route-CzX1plMs.js";import"./index-SLBSEZ_O.js";const N={__name:"subMenuItem",props:{menus:{type:Array,required:!0,default:()=>[]}},emits:["change"],setup(_,{emit:p}){const h=e("setMenuTag");return(e,p)=>{const x=v,k=a("subMenuItem",!0),y=P,g=R;return s(!0),n(l,null,t(_.menus,(e=>(s(),n(l,{key:e.name},[e.children&&e.children.length?(s(),u(y,{key:0,index:e.url},{title:r((()=>[i(x,{size:"18"},{default:r((()=>[e.menu_icon?(s(),u(o(e.menu_icon),{key:0})):c("",!0)])),_:2},1024),d("span",null,m(e.access_name),1)])),default:r((()=>[i(k,{menus:e.children},null,8,["menus"])])),_:2},1032,["index"])):(s(),u(g,{key:1,index:e.url,onClick:a=>f(h)(e)},{default:r((()=>[i(x,{size:"18"},{default:r((()=>[e.menu_icon?(s(),u(o(e.menu_icon),{key:0})):c("",!0)])),_:2},1024),d("span",null,m(e.access_name),1)])),_:2},1032,["index","onClick"]))],64)))),128)}}},O={class:"flex layout-container"},S={class:"view-container"},V={class:"view-container-header"},W={class:"items-center flex justify-bewteen"},X={class:"container-header-left flex"},Y={class:"container-header-right flex"},F={class:"icon svg-icon","aria-hidden":"true",style:{width:"25px",height:"21px"}},J={class:"flex cursor-pointer"},Q={class:"keepalive-routes-wrapper flex"},Z=_({__name:"index",setup(e){const _=p(),P=h(),R=x(),Z=D(),$=k(),G=y(R.getMenuList()),H=y(!1),ee=Z.states.activeMenu,ae=Z.states.menuTags,se=Z.states.kaRoutes,ne=R.adminUser,te=g((()=>3===ne.role_id));w((()=>{C.on("menusChange",ue)}));const le=g((()=>{const{informDetail:e,conversationListData:a}=$.state.Conversation;return(M.sumBy(e,"untreated")||0)+M.sumBy(M.values(a),"unreadMessageNum")})),ue=()=>{G.value=R.getMenuList()},re=e=>{"logout"===e&&(R.clearUserInfo(),setTimeout((()=>{location.href="/"})))},ie=e=>{Z.addMenuTag(e.menu_id,e),Z.addKaRoute(e.uri)},oe=y(!0);return b((()=>_.path),(e=>{const a=K(e);a&&ie(a),te.value&&(oe.value=e.includes("/chat"))}),{immediate:!0}),T("setMenuTag",ie),(e,p)=>{const h=U,x=a("Expand"),k=a("Fold"),y=v,g=a("router-link"),w=A,C=a("arrow-down"),M=a("SwitchButton"),b=E,T=L,R=q,D=B,K=a("router-view");return s(),n("div",O,[i(h,{router:"","background-color":"#304156","text-color":"#bfcbd9","active-text-color":"#409eff",collapse:H.value,defaultActive:f(ee).menuPath,style:{"overflow-y":"scroll"}},{default:r((()=>[i(N,{menus:G.value},null,8,["menus"])])),_:1},8,["collapse","defaultActive"]),d("div",S,[d("div",V,[d("div",W,[d("div",X,[i(y,{size:"21",class:"cursor-pointer",onClick:p[0]||(p[0]=e=>H.value=!H.value)},{default:r((()=>[H.value?(s(),u(x,{key:0})):(s(),u(k,{key:1}))])),_:1}),d("span",null,m(f(ee).accessName),1)]),d("div",Y,[!oe.value&&te.value?(s(),u(w,{key:0,value:le.value},{default:r((()=>[i(g,{to:"/chat/index"},{default:r((()=>[(s(),n("svg",F,p[1]||(p[1]=[d("use",{"xlink:href":"#icon-chat"},null,-1)])))])),_:1})])),_:1},8,["value"])):c("",!0),i(R,{onCommand:re},{dropdown:r((()=>[i(T,null,{default:r((()=>[i(b,{command:"logout"},{default:r((()=>[i(y,null,{default:r((()=>[i(M)])),_:1}),p[2]||(p[2]=j(" 退出登录 "))])),_:1})])),_:1})])),default:r((()=>[d("span",J,[j(m(f(ne).real_name||"")+" ",1),i(y,{class:"ml5"},{default:r((()=>[i(C)])),_:1})])])),_:1})])]),d("div",Q,[(s(!0),n(l,null,t(f(ae),(e=>(s(),u(D,{key:e.menu_id,closable:"",effect:e.menu_id===f(ee).menuId?"dark":"plain",class:"cursor-pointer",onClose:I((a=>(({menu_id:e,uri:a})=>{Z.deleteMenuTag(e,a)})(e)),["stop"]),onClick:a=>{return s=e,void(ee.menuId!==s.menu_id&&(s.hasOwnProperty("isExternal")&&s.isExternal?P.push({name:"redirect",params:{url:s.url},query:s.query}):P.push(s.url),Z.setActiveMenu(s.menu_id,s.access_name,s.url)));var s}},{default:r((()=>[j(m(e.access_name),1)])),_:2},1032,["effect","onClose","onClick"])))),128))])]),i(K,null,{default:r((({Component:e})=>[(s(),u(z,{include:f(se),max:10},[(s(),u(o(e),{key:f(_).name}))],1032,["include"]))])),_:1})])])}}},[["__scopeId","data-v-fec76131"]]);export{Z as default};
