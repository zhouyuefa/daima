import{_ as e,R as a,g as l,h as t,y as i,f as s,o as r,L as d,H as o}from"./index-BdR_P0jW.js";import{d as u}from"./dialogComp-DpPpTGA3.js";import"./index-DIDL6cCO.js";/* empty css                    */import"./index-TSZus3Mb.js";const p=e({__name:"shopTypeForm",props:{modelValue:{type:Boolean,default:!1},data:{type:Object,default:()=>({id:"000000000"})},addOrEdit:{type:String,default:""}},emits:["submit","refreshList"],setup(e,{emit:p}){const m=p,n=e,g=a((()=>n.modelValue)),f=a((()=>("edit"===n.addOrEdit?"编辑":"新增")+"商户类型")),y=a((()=>n.data.id)),b=l({}),_=e=>{for(const a of Object.keys(e))delete e[a]};t((()=>n.modelValue),(async e=>{e&&!y.value&&(_(b),b.is_top=0,b.is_menu=0)})),t(y,(async e=>{if(e??0){let e=JSON.parse(JSON.stringify(n.data));e.file_id={file_id:e.file_id,file_url:e.file_url},Object.assign(b,e),h()}else _(b)}));const c=l({parent_key:[{required:!0,message:"请选择",trigger:["blur","change"]}],key:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}],sort:[{required:!0,message:"请输入",trigger:"blur"}],file_id:[{required:!0,message:"请上传",trigger:"blur"}]}),v=l([]),h=async()=>{const{list:e}=await i("/admin/merchant/type/list",{status:"all",page:1,page_size:100,parent_key:"0"});if(!e)return;v.splice(0),e.map((e=>{v.push({value:e.key,label:e.name})}));let a=v.filter((e=>e.value!==n.data.key));v.splice(0),v.push(...a),v.unshift({value:"0",label:"一级分类"})};h();const O=s([{label:"父级分类:",type:"select",msg:"parent_key",options:v},{label:"Key:",type:"input",msg:"key",disabled:()=>"edit"==n.addOrEdit},{label:"类型名称:",type:"input",msg:"name"},{label:"排序:",type:"input",msg:"sort"},{label:"图标:",type:"imgUpload",msg:"file_id",group:"merLogo",file_type:"image"},{label:"url:",type:"input",msg:"link"},{label:"是否展示在首页:",type:"radio",msg:"is_top",options:[{label:"是",value:1},{label:"否",value:0}]},{label:"首页排序:",hide:e=>k(e),type:"input",msg:"top_sort"},{label:"是否展示在左侧:",type:"radio",msg:"is_menu",options:[{label:"是",value:1},{label:"否",value:0}]}]),k=e=>0!==e.is_top,j=async e=>{if(!e)return _(b),void m("refreshList","closeDialog");let a=JSON.parse(JSON.stringify(e));a.file_id=a.file_id.file_id||a.file_id.id;await i("/admin/merchant/type/save_submit",a)&&(o.success("保存成功"),m("refreshList","closeDialogAndRefresh"))};return(e,a)=>(r(),d(u,{modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=e=>g.value=e),formList:O.value,formData:b,rules:c,title:f.value,width:"550px",onSubmit:j},null,8,["modelValue","formList","formData","rules","title"]))}},[["__scopeId","data-v-bb125dcc"]]);export{p as default};
