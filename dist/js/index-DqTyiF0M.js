import{_ as e,Q as t,x as a,R as i,o,L as s,w as n,a as r,c,d,l as m,bI as p,i as u,J as l,K as _,t as f,e as T,fQ as g,ai as y,fJ as I,z as S,Y as v,Z as x,$ as R,b$ as h,H as U,ag as A}from"./index-BdR_P0jW.js";/* empty css                 *//* empty css                  *//* empty css                *//* empty css                */import{d as N}from"./dateFormater-BlBTgtQf.js";import{E as b}from"./index-C5ggMqbd.js";import{b as D}from"./index-C5CR2e01.js";import{E}from"./index-BY37MRSY.js";const O={class:"inforom_details_box"},j={class:"inforom_details_box_header"},k={key:0,class:"clear_inforom"},F={class:"inforom_details_time"},M={class:"time"},P={class:"card-header"},C={key:0,class:"badge"},B={class:"card-main"},G={class:"text item"},w={key:1},J=e({__name:"index",setup(e){const J=t(),L=a(),{INFORM_FROM:q}=g,{CHAT_TYPE:H}=A,$=i((()=>J.state.Conversation.informDetail)),z=()=>{y.confirm("确认清除所有系统通知?","清除系统通知",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{J.commit("CLEAR_INFORM_LIST")})).catch((()=>{}))},Q=({informData:e,index:t,type:a})=>{const i=I.user,{fromType:o,from:s}=e;if(o===q.FRIEND){({agree:()=>{I.acceptContactInvite(s),J.commit("UPDATE_INFORM_BTNSTATUS",{index:t,btnStatus:1})},refuse:()=>{I.declineContactInvite(s),J.commit("UPDATE_INFORM_BTNSTATUS",{index:t,btnStatus:2})}})[a]()}if(o===q.GROUP&&"inviteToJoin"===e.operation){({agree:async()=>{try{await I.acceptGroupInvite({invitee:i,groupId:e.groupId}),J.commit("UPDATE_INFORM_BTNSTATUS",{index:t,btnStatus:1}),await J.dispatch("fetchGroupList",{pageNum:1,pageSize:500}),L.push({path:"/chat/contacts/contactInfo",query:{id:e.groupId,chatType:H.GROUP}})}catch(a){return void U({type:"error",center:!0,message:"加入失败请稍后重试！"})}},refuse:async()=>{await I.rejectGroupInvite({invitee:i,groupId:e.groupId}),J.commit("UPDATE_INFORM_BTNSTATUS",{index:t,btnStatus:2})}})[a]()}if(o===q.GROUP&&"requestToJoin"===e.operation){({agree:async()=>{try{I.acceptGroupJoinRequest({applicant:s,groupId:e.groupId}),J.commit("UPDATE_INFORM_BTNSTATUS",{index:t,btnStatus:1})}catch(a){return void U({type:"error",center:!0,message:"同意失败请稍后重试！"})}},refuse:async()=>{I.rejectGroupJoinRequest({applicant:s,groupId:e.groupId,reason:"不好意思，不同意你的入群申请！"}),J.commit("UPDATE_INFORM_BTNSTATUS",{index:t,btnStatus:2})}})[a]()}};return(e,t)=>{const a=S,i=v,g=x,y=R,I=b,U=h,A=D,L=E;return $.value.length>0?(o(),s(A,{key:0,class:"app_container"},{default:n((()=>[r("div",O,[r("div",j,[$.value.length>0?(o(),c("div",k,[d(a,{onClick:z},{default:n((()=>[d(m(p))])),_:1})])):u("",!0)]),d(U,{tag:"div"},{default:n((()=>[(o(!0),c(l,null,_($.value,((e,a)=>(o(),c("div",{key:e.time},[r("div",F,[r("span",M,f(m(N)("MM-DD HH:mm",e.time)),1)]),d(I,{class:"inforom_details_card",onClick:t=>((e,t)=>{e.untreated&&J.commit("CLEAR_UNTREATED_STATUS",t)})(e,a),shadow:"never"},{header:n((()=>[r("div",P,[r("span",null,f(e.title)+" "+f(e.fromType===m(q).GROUP&&`(${e.groupId})`||""),1)])])),default:n((()=>[e.untreated?(o(),c("span",C)):u("",!0),r("div",B,[r("div",G,f(e.from)+"："+f(e.desc),1),e.isOpearationBtn&&e.operationStatus<1?(o(),s(y,{key:0,trigger:"click","split-button":"",type:"primary",onCommand:Q},{dropdown:n((()=>[d(g,null,{default:n((()=>[d(i,{command:{informData:e,index:a,type:"agree"}},{default:n((()=>t[0]||(t[0]=[T("同意")]))),_:2},1032,["command"]),d(i,{command:{informData:e,index:a,type:"refuse"}},{default:n((()=>t[1]||(t[1]=[T("拒绝")]))),_:2},1032,["command"])])),_:2},1024)])),default:n((()=>[t[2]||(t[2]=T(" 是否同意 "))])),_:2},1024)):u("",!0),e.operationStatus?(o(),c("div",w,[r("span",null,f(1===e.operationStatus?"已同意":2===e.operationStatus?"已拒绝":""),1)])):u("",!0)])])),_:2},1032,["onClick"])])))),128))])),_:1})])])),_:1})):(o(),s(L,{key:1,style:{height:"100%"},description:"暂无新的系统通知"}))}}},[["__scopeId","data-v-fc8d97b3"]]);export{J as default};
