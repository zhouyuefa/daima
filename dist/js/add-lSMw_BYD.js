import{_ as e,R as l,h as a,f as t,g as u,y as o,r as i,F as d,a2 as r,o as n,c as s,d as _,w as p,a as m,t as g,bW as c,bX as f,J as v,K as V,L as b,i as h,e as y,be as j,H as x,j as w,z as U,ad as k,ae as q,B as N,a8 as T,A as P,bQ as M,a9 as z,M as A,N as C,b_ as D,D as O,E as R}from"./index-BdR_P0jW.js";/* empty css                */import{_ as B,T as E}from"./index-PFFTJ-rA.js";import{P as G}from"./index-DIDL6cCO.js";import{E as J}from"./index-C5ggMqbd.js";/* empty css                    */import"./index-TSZus3Mb.js";const L={class:"app-container"},S={style:{"margin-bottom":"20px","font-size":"20px"}},F={style:{"vertical-align":"2px","padding-left":"20px"}},H=e({__name:"add",props:{modelValue:{type:Boolean,default:!1},selectedRowData:{type:Object,default:()=>{}}},emits:["commit","closeAddPage"],setup(e,{emit:H}){const I=H,K=e,Q=l((()=>K.selectedRowData.id));a(Q,(async e=>{e&&K.modelValue&&(Y(),W.value=!0)}));const W=t(!1),X=e=>{for(const l of Object.keys(e))delete e[l];j((()=>{var e;null==(e=null==te?void 0:te.value)||e.clearValidate("merchant_id")}))};a((()=>K.modelValue),(async e=>{var l;e&&!Q.value?(X(ae),null==(l=null==te?void 0:te.value)||l.clearValidate(),Z.value="新增商品",W.value=!0):e||(W.value=!1)}));const Z=t("新增商品"),Y=()=>{let e=JSON.parse(JSON.stringify(K.selectedRowData));e.goods_logo=e.goods_logo_url||{},e.goods_img=e.goods_img_url||[],e.jingxuan_img=e.jingxuan_img_url||{},e.tuijian_img=e.tuijian_img_url||{},Object.assign(ae,e),Z.value="编辑商品",pe.value=e,ce()},$=()=>{X(ae),I("closeAddPage")},ee=()=>{te.value.validate((e=>{if(!e)return x.error("表单校验失败，请根据页面提示填写"),!1;if(1===ae.wacn_settle_type){if(ae.wacn_settle_value>100)return x.error("结算比例不能大于100%")}else if(2===ae.wacn_settle_type&&ae.wacn_settle_value>ae.sale_price)return x.error("结算金额不能大于上架价格");return ae.cost_price>ae.sale_price?x.error("上架价格不能小于商户报价"):1===ae.integral_settle_type&&ae.integral_settle_value>100?x.error("积分结算比例不能大于100%"):ae.integral_settle_value>1e7?x.error("结算积分不能大于1000万"):ae.plate_user_inte_value>100?x.error("平台、用户积分分成不能大于100%"):(I("closeAddPage",ae),void X(ae))}))},le=t([]);(async()=>{const e=await w("/admin/dict/index/lists",{type:8,page:1,page_size:1e3});le.value=(null==e?void 0:e.lists.list)||[]})();const ae=u({}),te=t(null),ue=t({xl:10,lg:12,md:12,sm:24,xs:24}),oe=t({merchant_id:[{required:!0,message:"请选择商户",trigger:["change"]}],goods_name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],subtitle:[{required:!0,message:"请输入副标题",trigger:"blur"}],cost_price:[{required:!0,message:"请输入商户报价(TN)",trigger:"blur"}],refer_price:[{required:!0,message:"请输入划线价(TN)",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}],refund_config_id:[{required:!0,message:"请选择退款规则",trigger:["change"]}],goods_logo:[{required:!0,message:"请选择商品logo",trigger:["change"]}],goods_img:[{required:!0,message:"请选择商品轮播图",trigger:["change"]}],description:[{required:!0,message:"请输入商品详情",trigger:["change"]}],sale_price:[{required:!0,message:"请输入上架价格(TN)",trigger:["change"]}],wacn_settle_type:[{required:!0,message:"请输入分成结算方式",trigger:["change"]}],wacn_settle_value:[{required:!0,message:"请输入",trigger:"blur"}],integral_settle_value:[{required:!0,message:"请输入",trigger:"blur"}]}),ie=e=>{for(let l in e)return!1;return!0},de=e=>{ie(e)||(ae.goods_logo=e,ae.goods_logo_url=e)},re=e=>{e.length>0&&(ae.goods_img=e,ae.goods_img_url=e)},ne=e=>{ie(e)||(ae.tuijian_img=e,ae.tuijian_img_url=e)},se=e=>{ie(e)||(ae.jingxuan_img=e,ae.jingxuan_img=e)},_e=t([]);(async()=>{const e=await o("/admin/merchant/index/select_list");_e.value=(null==e?void 0:e.map((e=>({value:e.id,label:e.name,...e}))))||[]})();const pe=t({}),me=e=>{_e.value.forEach((l=>{l.value===e&&(pe.value=l)})),ce()},ge=t([]),ce=async()=>{const e=await o("/admin/merchant/order_refund_config/select_list",{merchant_type:pe.value.merchant_type});ge.value=(null==e?void 0:e.map((e=>({value:e.id,label:e.name,...e}))))||[]};return(e,l)=>{const a=i("DArrowLeft"),t=U,u=k,o=q,j=N,x=T,w=P,H=M,I=z,K=A,Q=C,X=D,Y=O,le=R,ie=J;return d((n(),s("div",L,[_(ie,{bordered:!1},{default:p((()=>[m("p",S,[_(t,{style:{"font-size":"16px",cursor:"pointer"},onClick:$},{default:p((()=>[_(a)])),_:1}),m("span",{style:{"vertical-align":"3px","font-size":"16px",cursor:"pointer"},onClick:$},"返回"),m("span",F,g(Z.value),1)]),_(le,{ref_key:"formValidateRef",ref:te,rules:oe.value,model:ae,"label-width":"130px"},{default:p((()=>[l[28]||(l[28]=m("p",{class:"title-config"},"商品基础信息",-1)),_(I,{gutter:24},{default:p((()=>[_(x,c(f(ue.value)),{default:p((()=>[_(j,{label:"选择商户：",prop:"merchant_id"},{default:p((()=>[_(o,{modelValue:ae.merchant_id,"onUpdate:modelValue":l[0]||(l[0]=e=>ae.merchant_id=e),placeholder:"请选择商户（可输入搜索）",filterable:"",clearable:"",onChange:me},{default:p((()=>[(n(!0),s(v,null,V(_e.value,(e=>(n(),b(u,{label:e.label,value:e.value,key:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},16),_(x,c(f(ue.value)),{default:p((()=>[_(j,{label:"商品名称：",prop:"goods_name"},{default:p((()=>[_(w,{modelValue:ae.goods_name,"onUpdate:modelValue":l[1]||(l[1]=e=>ae.goods_name=e),placeholder:"请输入商品名称"},null,8,["modelValue"])])),_:1})])),_:1},16),_(x,c(f(ue.value)),{default:p((()=>[_(j,{label:"副标题：",prop:"subtitle"},{default:p((()=>[_(w,{modelValue:ae.subtitle,"onUpdate:modelValue":l[2]||(l[2]=e=>ae.subtitle=e),placeholder:"请输入副标题"},null,8,["modelValue"])])),_:1})])),_:1},16),_(x,c(f(ue.value)),{default:p((()=>[_(j,{label:"商户报价(TN)：",prop:"cost_price"},{default:p((()=>[_(H,{class:"width200",modelValue:ae.cost_price,"onUpdate:modelValue":l[3]||(l[3]=e=>ae.cost_price=e),min:0,placeholder:"请输入商户报价"},null,8,["modelValue"])])),_:1})])),_:1},16),_(x,c(f(ue.value)),{default:p((()=>[_(j,{label:"划线价(TN)：",prop:"refer_price"},{default:p((()=>[_(H,{class:"width200",modelValue:ae.refer_price,"onUpdate:modelValue":l[4]||(l[4]=e=>ae.refer_price=e),type:"number",min:0,placeholder:"请输入划线价"},null,8,["modelValue"])])),_:1})])),_:1},16),_(x,c(f(ue.value)),{default:p((()=>[_(j,{label:"排序：",prop:"sort"},{default:p((()=>[_(w,{modelValue:ae.sort,"onUpdate:modelValue":l[5]||(l[5]=e=>ae.sort=e),type:"number",placeholder:"请输入排序"},null,8,["modelValue"])])),_:1})])),_:1},16),_(x,c(f(ue.value)),{default:p((()=>[_(j,{label:"退款规则：",prop:"refund_config_id"},{default:p((()=>[_(o,{modelValue:ae.refund_config_id,"onUpdate:modelValue":l[6]||(l[6]=e=>ae.refund_config_id=e),placeholder:"请选择"},{default:p((()=>[(n(!0),s(v,null,V(ge.value,(e=>(n(),b(u,{label:e.label,value:e.value,key:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},16),_(x,{span:24},{default:p((()=>[_(j,{label:"商品封面图：",prop:"goods_logo"},{default:p((()=>[_(G,{modelValue:ae.goods_logo,"onUpdate:modelValue":l[7]||(l[7]=e=>ae.goods_logo=e),onGetPic:de,group:"goodsLogo",tip:"图片大小不超过2M，最多上传1张，比例大小1:1",file_type:"image",num:1,width:"150px",height:"150px"},null,8,["modelValue"])])),_:1})])),_:1}),_(x,{span:24},{default:p((()=>[_(j,{label:"商品轮播图：",prop:"goods_img"},{default:p((()=>[_(B,{modelValue:ae.goods_img,"onUpdate:modelValue":l[8]||(l[8]=e=>ae.goods_img=e),tip:"图片大小不超过2M，最多上传5张，比例大小4:3",group:"merBanner",file_type:"image",onMulpicUpload:re,num:5,width:"200px",height:"150px"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),_(I,null,{default:p((()=>[_(x,{span:24},{default:p((()=>[_(j,{label:"商品详情：",prop:"description"},{default:p((()=>[_(E,{modelValue:ae.description,"onUpdate:modelValue":l[9]||(l[9]=e=>ae.description=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),l[29]||(l[29]=m("p",{class:"title-config"},"结算设置",-1)),_(I,null,{default:p((()=>[_(x,c(f(ue.value)),{default:p((()=>[_(j,{label:"分成结算方式：",prop:"wacn_settle_type"},{default:p((()=>[_(Q,{modelValue:ae.wacn_settle_type,"onUpdate:modelValue":l[10]||(l[10]=e=>ae.wacn_settle_type=e)},{default:p((()=>[_(K,{value:2,label:"固定额度"}),_(K,{value:1,label:"比例结算"})])),_:1},8,["modelValue"])])),_:1}),1===ae.wacn_settle_type?(n(),b(j,{key:0,label:"结算比例(%)：",prop:"wacn_settle_value"},{default:p((()=>[_(H,{class:"width200",modelValue:ae.wacn_settle_value,"onUpdate:modelValue":l[11]||(l[11]=e=>ae.wacn_settle_value=e),type:"number",min:0,placeholder:"请输入结算比例"},null,8,["modelValue"])])),_:1})):2===ae.wacn_settle_type?(n(),b(j,{key:1,label:"结算金额(TN)：",prop:"wacn_settle_value"},{default:p((()=>[_(H,{class:"width200",modelValue:ae.wacn_settle_value,"onUpdate:modelValue":l[12]||(l[12]=e=>ae.wacn_settle_value=e),type:"number",min:0,placeholder:"请输入结算金额"},null,8,["modelValue"])])),_:1})):h("",!0)])),_:1},16),_(x,c(f(ue.value)),{default:p((()=>[_(j,{label:"积分结算方式：",prop:"integral_settle_type"},{default:p((()=>[_(Q,{modelValue:ae.integral_settle_type,"onUpdate:modelValue":l[13]||(l[13]=e=>ae.integral_settle_type=e)},{default:p((()=>[_(K,{value:2,label:"固定数值"}),_(K,{value:1,label:"比例结算"})])),_:1},8,["modelValue"])])),_:1}),1===ae.integral_settle_type?(n(),b(j,{key:0,label:"结算比例(%)：",prop:"integral_settle_value"},{default:p((()=>[_(H,{class:"width200",modelValue:ae.integral_settle_value,"onUpdate:modelValue":l[14]||(l[14]=e=>ae.integral_settle_value=e),type:"number",min:0,placeholder:"请输入结算比例"},null,8,["modelValue"])])),_:1})):2===ae.integral_settle_type?(n(),b(j,{key:1,label:"结算积分：",prop:"integral_settle_value"},{default:p((()=>[_(H,{class:"width200",modelValue:ae.integral_settle_value,"onUpdate:modelValue":l[15]||(l[15]=e=>ae.integral_settle_value=e),type:"number",min:0,placeholder:"请输入结算积分"},null,8,["modelValue"])])),_:1})):h("",!0)])),_:1},16)])),_:1}),l[30]||(l[30]=m("p",{class:"title-config"},"平台价格设置",-1)),_(I,null,{default:p((()=>[_(x,c(f(ue.value)),{default:p((()=>[_(j,{label:"上架价格(TN)：",prop:"sale_price"},{default:p((()=>[_(H,{class:"width200",modelValue:ae.sale_price,"onUpdate:modelValue":l[16]||(l[16]=e=>ae.sale_price=e),type:"number",min:0,placeholder:"请输入上架价格(TN)"},null,8,["modelValue"])])),_:1})])),_:1},16)])),_:1}),l[31]||(l[31]=m("p",{class:"title-config"},"平台、用户积分分成",-1)),_(I,null,{default:p((()=>[_(x,c(f(ue.value)),{default:p((()=>[_(j,{label:"结算积分(%)：",prop:"plate_user_inte_value"},{default:p((()=>[_(H,{class:"width200",modelValue:ae.plate_user_inte_value,"onUpdate:modelValue":l[17]||(l[17]=e=>ae.plate_user_inte_value=e),min:0,placeholder:"请输入结算积分"},null,8,["modelValue"])])),_:1})])),_:1},16)])),_:1}),_(I,null,{default:p((()=>[_(x,c(f(ue.value)),{default:p((()=>[l[24]||(l[24]=m("p",{class:"title-config"},"首页推荐设置",-1)),_(j,{label:"是否推荐：",prop:"is_tuijian"},{default:p((()=>[_(X,{modelValue:ae.is_tuijian,"onUpdate:modelValue":l[18]||(l[18]=e=>ae.is_tuijian=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),1===ae.is_tuijian?(n(),b(j,{key:0,label:"商品推荐图：",prop:"tuijian_img"},{default:p((()=>[_(G,{modelValue:ae.tuijian_img,"onUpdate:modelValue":l[19]||(l[19]=e=>ae.tuijian_img=e),tip:"图片大小不超过2M，最多上传1张",group:"tuijian",file_type:"image",onGetPic:ne,num:1,width:"150px",height:"150px"},null,8,["modelValue"])])),_:1})):h("",!0),1===ae.is_tuijian?(n(),b(j,{key:1,label:"推荐排序：",prop:"tuijian_sort"},{default:p((()=>[_(w,{modelValue:ae.tuijian_sort,"onUpdate:modelValue":l[20]||(l[20]=e=>ae.tuijian_sort=e),placeholder:"请输入推荐排序"},null,8,["modelValue"])])),_:1})):h("",!0)])),_:1},16),_(x,c(f(ue.value)),{default:p((()=>[l[25]||(l[25]=m("p",{class:"title-config"},"首页精选设置",-1)),_(j,{label:"是否精选：",prop:"is_jingxuan"},{default:p((()=>[_(X,{modelValue:ae.is_jingxuan,"onUpdate:modelValue":l[21]||(l[21]=e=>ae.is_jingxuan=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),1===ae.is_jingxuan?(n(),b(j,{key:0,label:"商品精选图：",prop:"jingxuan_img"},{default:p((()=>[_(G,{modelValue:ae.jingxuan_img,"onUpdate:modelValue":l[22]||(l[22]=e=>ae.jingxuan_img=e),tip:"图片大小不超过2M，最多上传1张，比例大小 3:4 ",group:"jingxuan",file_type:"image",onGetPic:se,num:1,width:"150px",height:"200px"},null,8,["modelValue"])])),_:1})):h("",!0),1===ae.is_jingxuan?(n(),b(j,{key:1,label:"精选排序：",prop:"jingxuan_sort"},{default:p((()=>[_(w,{modelValue:ae.jingxuan_sort,"onUpdate:modelValue":l[23]||(l[23]=e=>ae.jingxuan_sort=e),placeholder:"请输入精选排序"},null,8,["modelValue"])])),_:1})):h("",!0)])),_:1},16)])),_:1}),_(j,null,{default:p((()=>[_(Y,{onClick:$},{default:p((()=>l[26]||(l[26]=[y("取消")]))),_:1}),_(Y,{type:"primary",onClick:ee},{default:p((()=>l[27]||(l[27]=[y("保存")]))),_:1})])),_:1})])),_:1},8,["rules","model"])])),_:1})],512)),[[r,W.value]])}}},[["__scopeId","data-v-45f7f0c1"]]);export{H as default};
