import{_ as e,f as a,j as l,g as t,T as o,S as s,r as i,o as n,c as r,a as p,d,w as u,e as b,t as c,y as h,aw as _,D as m,aa as g}from"./index-BdR_P0jW.js";/* empty css                */import{E as v}from"./index-C5CR2e01.js";const y={class:"boxElMain"},f={class:"box boxFlex"},w={class:"dialog-footer"},x=e({__name:"index",setup(e){const x=a({getList:"/admin/customer_bills/index/user_point_bill_list"}),W=a([{type:"Input",label:"用户ID",prop:"user_id",placeholder:"请输入",width:"180px"},{type:"Input",label:"手机号",prop:"mobile",width:"180px",placeholder:"请输入"},{type:"Input",label:"关联订单号",prop:"order_no",width:"180px",placeholder:"请输入订单号"},{type:"DateRange",label:"日期",prop:"created_at",placeholder:"请输入类型名称",width:"280px"},{type:"Select",label:"流水类型",options:[{label:"收入",value:"1"},{label:"抵扣",value:"2"}],prop:"data_type",width:"180px",placeholder:"请输入"}]),D=a({user_id:"",mobile:"",order_no:"",data_type:"",created_at:[]}),j=a([{label:"查 询",icon:"Search",auth:"admin/customer_bills/index/user_point_bill_list",handle:()=>V()},{label:"重置",auth:"admin/customer_bills/index/user_point_bill_list",handle:()=>E()},{label:"排序",popover:!0}]),C=a([]),H=a([]),P=a({page:1,page_size:20,totalPages:0}),k=a([{label:"序号",prop:"id",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"流水单号",prop:"bill_no",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0},{label:"关联订单号",prop:"order_good_info",subProp:"order_no",align:"center",type:"object",sortable:!1,minWidth:"160",show:!0},{label:"用户名",prop:"user_info",subProp:"nickname",align:"center",type:"object",sortable:!1,minWidth:"120",show:!0},{label:"用户ID",prop:"user_info",subProp:"id",align:"center",type:"object",sortable:!1,minWidth:"120",show:!0},{label:"手机号",prop:"user_info",subProp:"mobile",align:"center",type:"object",sortable:!1,minWidth:"120",show:!0},{label:"流水类型",prop:"data_type_text",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"期初余额",prop:"point_before",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"发生金额",prop:"point",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"期后余额",prop:"point_after",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"创建时间",prop:"created_at",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0}]),I=a([]),S=a(!1),V=()=>{P.value.page=1,R()},E=()=>{(e=>{for(const a of Object.keys(e))delete e[a]})(D.value),P.value.page=1,P.value.page_size=20,R()},F=a({}),R=async()=>{const e=await l(x.value.getList,{...P.value,...D.value});if(e&&(H.value=[],P.value.total=e.page.total||0,H.value.splice(0),F.value=e.statistics,e.list.length>0))for(let a=0;a<e.list.length;a++){let l=e.list[a];H.value.push(l)}},O=t({});o.on("getCheckData",(e=>{(e=>{const a=[];e.list.forEach((e=>{a.push(e.label)})),k.value.sort(((e,l)=>"操作"===e.label?1:a.indexOf(e.label)-a.indexOf(l.label))),k.value=k.value.map((a=>e.data.includes(a.label)||"操作"===a.label?{...a,show:!0}:{...a,show:!1}))})(e)})),s((()=>{R()}));const T=a(!1),z=async()=>{let e={id:O.id};await h("/admin/merchant/type/update_status",e)&&(R(),T.value=!1)};return(e,a)=>{const l=_,t=i("cusTable"),o=v,s=i("DetailForm"),h=m,x=g;return n(),r("div",y,[p("div",f,[d(o,null,{default:u((()=>[d(l,{searchForm:W.value,searchData:D.value,searchHandleRight:C.value,searchHandle:j.value,tableCols:k.value,onHandleEnterSearch:V,onHandleReset:E},null,8,["searchForm","searchData","searchHandleRight","searchHandle","tableCols"]),d(t,{ref:"cusTable",height:"calc(100vh - 320px)","row-key":"id",isPagination:!0,isHandle:!0,tableCols:k.value,tableData:H.value,tablePage:P.value,onHandleCurrentChange:R},null,8,["tableCols","tableData","tablePage"])])),_:1})]),d(s,{modelValue:S.value,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value=e),data:I.value,onSubmit:e.refreshMenu},null,8,["modelValue","data","onSubmit"]),d(x,{modelValue:T.value,"onUpdate:modelValue":a[2]||(a[2]=e=>T.value=e),title:"提示",width:"500"},{footer:u((()=>[p("div",w,[d(h,{onClick:a[1]||(a[1]=e=>T.value=!1)},{default:u((()=>a[3]||(a[3]=[b("取消")]))),_:1}),d(h,{type:"primary",onClick:z},{default:u((()=>a[4]||(a[4]=[b(" 确定 ")]))),_:1})])])),default:u((()=>[p("span",null,"确定要"+c(1===O.status?"禁用":"启用")+"该类型吗",1)])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-9122b22a"]]);export{x as default};
