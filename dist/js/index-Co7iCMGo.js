import{_ as e,f as a,g as l,al as s,ah as i,o as t,c as r,d as o,w as n,a as p,e as u,F as d,L as c,j as m,H as _,ai as g,y as f,A as y,D as v,a3 as h,af as w,a4 as x,a5 as b}from"./index-BdR_P0jW.js";/* empty css                *//* empty css                    */import{E as z}from"./index-TSZus3Mb.js";import{E as k}from"./index-C5ggMqbd.js";const j={class:"mb20 flex items-center"},C=["src"],B=["src"],U=["src"],V=["src"],D=["src"],E=["src"],I={key:3},P=e(Object.assign({name:"admin/upload/index"},{__name:"index",setup(e){const P=a([]);a(!1),l({});const S=a(s+"/upload/file"),T=a({file_name:"",role_id:"all"}),A=a({page:1,page_size:20,total:0}),F=async()=>{const e=await m("/admin/upload/index/lists",{file_name:T.value.file_name,page:A.value.page,page_size:A.value.page_size});e&&(P.value=(null==e?void 0:e.lists.list)||[],A.value=(null==e?void 0:e.lists.page)||{})},H=e=>{A.value.page_size=e,F()},L=e=>{A.value.page=e,F()},O=(e,a,l)=>{200==e.code?(_({type:"success",message:"上传成功"}),F()):_({type:"error",message:e.msg,duration:5e3})},Z=async({file_id:e})=>{g.confirm("是否确认删除该记录？【只删除文件记录，实际文件未删除】","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{await f("/component/upload/file/delete",{selected_file_ids:[e]})&&(_({type:"success",message:"删除成功"}),(async()=>{F()})())})).catch((()=>{}))};return(async()=>{F()})(),(e,a)=>{const l=y,s=v,m=z,_=h,g=w,f=x,q=b,G=k,J=i("hasPermi");return t(),r("div",null,[o(G,null,{header:n((()=>a[4]||(a[4]=[p("span",null,"文件列表",-1)]))),default:n((()=>[p("div",j,[o(l,{modelValue:T.value.file_name,"onUpdate:modelValue":a[0]||(a[0]=e=>T.value.file_name=e),style:{width:"280px"},placeholder:"文件名称"},null,8,["modelValue"]),o(s,{class:"ml30",type:"primary",onClick:a[1]||(a[1]=e=>(A.value.page=1,void F()))},{default:n((()=>a[5]||(a[5]=[u("查询")]))),_:1}),o(m,{class:"ml30 upload-demo",action:S.value,"on-success":O},{trigger:n((()=>[d((t(),c(s,{type:"primary"},{default:n((()=>a[6]||(a[6]=[u("选择上传图片")]))),_:1})),[[J,["api/upload/file"]]])])),_:1},8,["action"])]),o(f,{data:P.value,"row-key":"admin_user_id","default-expand-all":"",class:"mt5",style:{height:"calc(100% - 350px)"}},{default:n((()=>[o(_,{prop:"file_id",label:"ID","min-width":"10",sortable:""}),o(_,{prop:"file_name",label:"文件名称","min-width":"10"}),o(_,{prop:"file_type",label:"文件类型","min-width":"10"}),o(_,{prop:"file_size",label:"大小(B)","min-width":"10"}),o(_,{prop:"file_url",label:"图片",width:"360px"},{default:n((({row:e})=>[["image","img"].includes(e.file_type)?(t(),c(g,{key:0,style:{width:"100px",height:"100px"},src:e.file_url,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[e.file_url]},null,8,["src","preview-src-list"])):"video"===e.file_type?(t(),r("video",{key:1,src:e.file_url,width:"135",height:"240",controls:""},[p("source",{src:e.file_url,type:"video/mp4"},null,8,B),p("source",{src:e.file_url,type:"video/ogg"},null,8,U),a[7]||(a[7]=u(" 您的浏览器不支持 video 标签。 "))],8,C)):"audio"===e.file_type?(t(),r("audio",{key:2,controls:"",src:e.file_url},[p("source",{src:e.file_url,type:"audio/ogg"},null,8,D),p("source",{src:e.file_url,type:"audio/mpeg"},null,8,E),a[8]||(a[8]=u(" 您的浏览器不支持 audio 元素。 "))],8,V)):(t(),r("span",I,"未知文件类型"))])),_:1}),o(_,{prop:"file_path",label:"文件路径","min-width":"10"}),o(_,{prop:"updated_at",label:"创造时间","min-width":"10"}),o(_,{label:"操作",align:"center",width:"220","min-width":"220"},{default:n((({row:e})=>[d((t(),c(s,{type:"danger",onClick:a=>Z(e)},{default:n((()=>a[9]||(a[9]=[u("删除")]))),_:2},1032,["onClick"])),[[J,["admin/upload/delete"]]])])),_:1})])),_:1},8,["data"]),o(q,{background:"",layout:"total, sizes, prev, pager, next, ->,jumper","current-page":A.value.page,"onUpdate:currentPage":a[2]||(a[2]=e=>A.value.page=e),"page-size":A.value.page_size,"onUpdate:pageSize":a[3]||(a[3]=e=>A.value.page_size=e),total:A.value.total,class:"ml10 mt10",onSizeChange:H,onCurrentChange:L},null,8,["current-page","page-size","total"])])),_:1})])}}}),[["__scopeId","data-v-1aecb22c"]]);export{P as default};
