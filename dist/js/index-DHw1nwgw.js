import{f as e,y as a,T as l,S as t,r as o,o as r,c as n,a as s,d as i,w as p,aw as d}from"./index-BdR_P0jW.js";/* empty css                */import{E as b}from"./index-C5CR2e01.js";const c={class:"boxElMain"},h={class:"box boxFlex"},u={__name:"index",setup(u){const g=e({getList:"/admin/user_bill/lists",exportUrl:"/admin/user_bill/export_lists"});e([{label:"全部",value:"all"},{label:"启用",value:"1"},{label:"禁用",value:"2"}]);const m=e([{type:"Input",label:"商户名称",prop:"name",placeholder:"请输入商户名称",width:"180px"},{type:"Input",label:"订单号",prop:"order_no",width:"180px",placeholder:"请输入订单号"},{type:"DateRange",label:"日期",prop:"created_at",placeholder:"请选择日期",width:"280px"}]),_=e({name:"",order_no:"",created_at:""}),v=e([{label:"查 询",icon:"Search",auth:"admin/user_bill/lists",handle:()=>W()},{label:"重置",auth:"admin/user_bill/lists",handle:()=>C()},{label:"排序",popover:!0}]),w=e([{label:"导出",icon:"Download",auth:"admin/user_bill/export_lists",handle:()=>j()}]),y=e([]),f=e({page:1,page_size:20}),x=e([{label:"序号",prop:"id",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"商户名称",prop:"merchant_info",subProp:"name",align:"center",type:"object",sortable:!1,minWidth:"120",show:!0},{label:"流水单号",prop:"bill_no",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"订单号",prop:"order_goods_info",subProp:"order_no",align:"center",type:"object",sortable:!1,minWidth:"180",show:!0},{label:"类型",prop:"type_text",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"订单金额（TN）",prop:"order_goods_info",subProp:"order_price",align:"center",type:"object",sortable:!1,minWidth:"120",show:!0},{label:"消费税金额",prop:"order_goods_info",subProp:"tax_price",align:"center",type:"object",sortable:!1,minWidth:"120",show:!0},{label:"商户分成比例",prop:"settle_value",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"商户应结算金额",prop:"merchant_price",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"WACN冻结余额",prop:"merchant_freeze_after",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"创建时间",prop:"created_at",align:"center",type:"string",sortable:!1,minWidth:"160",show:!0}]),W=()=>{f.value.page=1,H()},C=()=>{(e=>{for(const a of Object.keys(e))delete e[a]})(_.value),f.value.page=1,f.value.page_size=20,H()},j=async()=>{const e=await a(g.value.exportUrl,{..._.value});if(e){const a=document.createElement("a");a.href=e,a.target="_blank",a.download=e.split("/").pop(),document.body.appendChild(a),a.click(),document.body.removeChild(a)}},H=async e=>{const l=await a(g.value.getList,{...f.value,..._.value});if(l&&(y.value=[],f.value.total=l.page.total||0,y.value.splice(0),l.list.length>0))for(let a=0;a<l.list.length;a++){let e=l.list[a];y.value.push(e)}};return l.on("getCheckData",(e=>{(e=>{const a=[];e.list.forEach((e=>{a.push(e.label)})),x.value.sort(((e,l)=>"操作"===e.label?1:a.indexOf(e.label)-a.indexOf(l.label))),x.value=x.value.map((a=>e.data.includes(a.label)||"操作"===a.label?{...a,show:!0}:{...a,show:!1}))})(e)})),t((()=>{H()})),(e,a)=>{const l=d,t=o("cusTable"),u=b;return r(),n("div",c,[s("div",h,[i(u,null,{default:p((()=>[i(l,{searchForm:m.value,searchData:_.value,searchHandleRight:w.value,searchHandle:v.value,tableCols:x.value,onHandleEnterSearch:W,onHandleReset:C},null,8,["searchForm","searchData","searchHandleRight","searchHandle","tableCols"]),i(t,{ref:"cusTable",height:"calc(100vh - 240px)","row-key":"id",isPagination:!0,isHandle:!0,tableCols:x.value,tableData:y.value,tablePage:f.value,onHandleCurrentChange:H},null,8,["tableCols","tableData","tablePage"])])),_:1})])])}}};export{u as default};
