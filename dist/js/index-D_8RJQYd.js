import{f as e,g as a,ai as l,y as t,j as n,T as r,S as i,r as o,o as s,c as u,a as d,d as c,w as p,e as b,H as m,aw as h,M as g,N as v,B as _,A as y,E as f,D as w,aa as x}from"./index-BdR_P0jW.js";/* empty css                */import{E as k}from"./index-C5CR2e01.js";const V={class:"boxElMain"},W={class:"box boxFlex"},C={class:"dialog-footer"},H={__name:"index",setup(H){const D=e({getList:"/admin/user_bank/lists",getDetail:"/admin/user_bank/detail",edit_save:"/admin/user_bank/edit_save",delCard:"/admin/user_bank/del"}),j=e([{type:"Input",label:"用户名",prop:"nickname",placeholder:"请输入用户名",width:"180px"},{type:"Input",label:"手机号",prop:"mobile",placeholder:"请输入手机号",width:"180px"}]),U=e({nickname:"",mobile:""}),q=e([{label:"查 询",icon:"Search",handle:()=>B()},{label:"重置",handle:()=>A()},{label:"排序",popover:!0}]),E=e([]),T=e([]),F=e({page:1,page_size:20}),O=e([{label:"序号",prop:"id",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"用户ID",prop:"user_id",align:"center",type:"string",sortable:!1,minWidth:"80",show:!0},{label:"用户名",prop:"nickname",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"手机号",prop:"mobile",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"账户类型",prop:"type_text",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"名称",prop:"account_name",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"银行账号",prop:"account_number",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"开户行",prop:"account_bank",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"开户支行",prop:"branch",align:"center",type:"string",sortable:!1,minWidth:"120",show:!0},{label:"创建时间",prop:"created_time",align:"center",type:"timestamp",sortable:!1,minWidth:"160",show:!0},{label:"修改时间",prop:"updated_time",align:"center",type:"timestamp",sortable:!1,minWidth:"160",show:!0},{label:"操作",minWidth:"160",type:"button",show:!0,fixed:"right",align:"center",btnList:[{label:"编辑",type:"primary",auth:"['admin/version/detail']",handle:(e,a)=>P(a)},{label:"删除",type:"danger",auth:"['admin/version/detail']",handle:(e,a)=>M(a)}]}]),B=()=>{F.value.page=1,N()},I=a({}),L=e(!1),P=e=>{Object.assign(I,e),L.value=!0},R=e(null),S=e({type:[{required:!0,message:"请选择账户类型",trigger:"change"}],account_name:[{required:!0,message:"请输入名称",trigger:"blur"}],account_number:[{required:!0,message:"请输入银行账号",trigger:"blur"}],account_bank:[{required:!0,message:"请输入开户行",trigger:"blur"}],branch:[{required:!0,message:"请输入开户支行",trigger:"blur"}]}),z=async()=>{R.value.validate((async e=>{if(!e)return void m.error("校验未通过，请根据页面提示填写");let a={...I};await t(D.value.edit_save,a)&&(N(),L.value=!1)}))},M=async e=>{l.confirm("确认删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((async()=>{await t(D.value.delCard,{id:e.id})&&N()})).catch((()=>{}))},A=()=>{(e=>{for(const a of Object.keys(e))delete e[a]})(U.value),F.value.page=1,F.value.page_size=20,N()},N=async()=>{const e=await n(D.value.getList,{...F.value,...U.value});if(e&&(T.value=[],F.value.total=e.list.total||0,T.value.splice(0),e.list.length>0))for(let a=0;a<e.list.length;a++){let l=e.list[a];T.value.push(l)}};return r.on("getCheckData",(e=>{(e=>{const a=[];e.list.forEach((e=>{a.push(e.label)})),O.value.sort(((e,l)=>"操作"===e.label?1:a.indexOf(e.label)-a.indexOf(l.label))),O.value=O.value.map((a=>e.data.includes(a.label)||"操作"===a.label?{...a,show:!0}:{...a,show:!1}))})(e)})),i((()=>{N()})),(e,a)=>{const l=h,t=o("cusTable"),n=k,r=g,i=v,m=_,H=y,D=f,P=w,M=x;return s(),u("div",V,[d("div",W,[c(n,null,{default:p((()=>[c(l,{searchForm:j.value,searchData:U.value,searchHandleRight:E.value,searchHandle:q.value,tableCols:O.value,onHandleEnterSearch:B,onHandleReset:A},null,8,["searchForm","searchData","searchHandleRight","searchHandle","tableCols"]),c(t,{ref:"cusTable",height:"calc(100vh - 240px)","row-key":"id",isPagination:!0,isHandle:!0,tableCols:O.value,tableData:T.value,tablePage:F.value,onHandleCurrentChange:N},null,8,["tableCols","tableData","tablePage"])])),_:1})]),c(M,{modelValue:L.value,"onUpdate:modelValue":a[6]||(a[6]=e=>L.value=e),title:"编辑",width:"500"},{footer:p((()=>[d("div",C,[c(P,{onClick:a[5]||(a[5]=e=>L.value=!1)},{default:p((()=>a[9]||(a[9]=[b("取消")]))),_:1}),c(P,{type:"primary",onClick:z},{default:p((()=>a[10]||(a[10]=[b("确定")]))),_:1})])])),default:p((()=>[d("div",null,[c(D,{ref_key:"editForm",ref:R,rules:S.value,model:I,"label-width":"80px"},{default:p((()=>[c(m,{label:"账户类型",prop:"type"},{default:p((()=>[c(i,{modelValue:I.type,"onUpdate:modelValue":a[0]||(a[0]=e=>I.type=e)},{default:p((()=>[c(r,{label:1},{default:p((()=>a[7]||(a[7]=[b("企业")]))),_:1}),c(r,{label:2},{default:p((()=>a[8]||(a[8]=[b("个人")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),c(m,{label:"名称",prop:"account_name"},{default:p((()=>[c(H,{type:"text",modelValue:I.account_name,"onUpdate:modelValue":a[1]||(a[1]=e=>I.account_name=e)},null,8,["modelValue"])])),_:1}),c(m,{label:"银行账号",prop:"account_number"},{default:p((()=>[c(H,{type:"text",modelValue:I.account_number,"onUpdate:modelValue":a[2]||(a[2]=e=>I.account_number=e)},null,8,["modelValue"])])),_:1}),c(m,{label:"开户行",prop:"account_bank"},{default:p((()=>[c(H,{type:"text",modelValue:I.account_bank,"onUpdate:modelValue":a[3]||(a[3]=e=>I.account_bank=e)},null,8,["modelValue"])])),_:1}),c(m,{label:"开户支行",prop:"branch"},{default:p((()=>[c(H,{type:"text",modelValue:I.branch,"onUpdate:modelValue":a[4]||(a[4]=e=>I.branch=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])])),_:1},8,["modelValue"])])}}};export{H as default};
